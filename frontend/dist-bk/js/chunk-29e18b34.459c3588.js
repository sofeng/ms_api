(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29e18b34"],{"00f1":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"report-export"},[n("ms-report-title",{attrs:{title:t.title,type:t.type}}),t._t("default")],2)},a=[],o=n("cd3e"),i={name:"MsReportExportTemplate",components:{MsReportTitle:o["a"]},props:{title:String,type:String}},r=i,l=(n("95ad"),n("cba8")),c=Object(l["a"])(r,s,a,!1,null,"e651856c",null);e["a"]=c.exports},"1e6b":function(t,e,n){"use strict";n("2c1c")},"2c1c":function(t,e,n){},"2ccb":function(t,e,n){},"344e":function(t,e,n){},"3f21":function(t,e,n){},4191:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",["TEST_PLAN_API"===t.triggerMode?n("span",[t._v(t._s(t.$t("commons.trigger_mode.api")))]):t._e(),"MANUAL"===t.triggerMode?n("span",[t._v(t._s(t.$t("commons.trigger_mode.manual")))]):t._e(),"SCHEDULE"===t.triggerMode?n("span",[t._v(t._s(t.$t("commons.trigger_mode.schedule")))]):t._e(),"TEST_PLAN_SCHEDULE"===t.triggerMode?n("span",[t._v(t._s(t.$t("commons.trigger_mode.schedule")))]):t._e(),"API"===t.triggerMode?n("span",[t._v(t._s(t.$t("commons.trigger_mode.api")))]):t._e(),"BATCH"===t.triggerMode?n("span",[t._v(t._s(t.$t("api_test.automation.batch_execute")))]):t._e()])},a=[],o={name:"ReportTriggerModeItem",props:["triggerMode"]},i=o,r=n("cba8"),l=Object(r["a"])(i,s,a,!1,null,"43af7f24",null);e["a"]=l.exports},"4a98":function(t,e,n){},"5f11":function(t,e,n){t.exports=n.p+"img/logo-MeterSphere.041f133a.png"},6602:function(t,e,n){"use strict";n("ac4b")},"665c":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isShow?n("el-table-column",{attrs:{width:"1",resizable:!1,fixed:"left",align:"center"}},[n("el-popover",{staticStyle:{"margin-right":"0px"},attrs:{slot:"header",placement:"right",trigger:"click"},slot:"header"},[n("el-link",{ref:"selectAllLink",nativeOn:{click:function(e){return e.stopPropagation(),t.click("selectAll")}}},[n("span",{style:t.selectAllFontColor},[t._v(" "+t._s(t.$t("api_test.batch_menus.select_all_data",[t.total]))+" ")])]),n("br"),n("el-link",{ref:"selectPageAllLink",nativeOn:{click:function(e){return e.stopPropagation(),t.click("selectPageAll")}}},[n("span",{style:t.selectPageFontColor},[t._v(" "+t._s(t.$t("api_test.batch_menus.select_show_data",[t.tableDataCountInPage]))+" ")])]),n("i",{staticClass:"el-icon-arrow-down table-select-icon",attrs:{slot:"reference"},slot:"reference"})],1)],1):t._e()},a=[],o=(n("51b3"),{name:"MsTableHeaderSelectPopover",props:{total:{type:Number,default:function(){return 10}},pageSize:{type:Number,default:function(){return 10}},tableDataCountInPage:{type:Number,default:function(){return 10}},selectDataCounts:{type:Number,default:function(){return 0}}},created:function(){0===this.keyIndex&&(this.keyIndex++,this.reload())},data:function(){return{isShow:!0,selectAllFontColor:{color:"gray"},selectPageFontColor:{color:"gray"},keyIndex:0}},methods:{click:function(t){"selectPageAll"===t?(this.selectAllFontColor.color="gray",this.selectPageFontColor.color=document.body.style.getPropertyValue("--count_number")):"selectAll"===t?(this.selectAllFontColor.color=document.body.style.getPropertyValue("--count_number"),this.selectPageFontColor.color="gray"):(this.selectAllFontColor.color="gray",this.selectPageFontColor.color="gray"),0===this.keyIndex&&(this.keyIndex++,this.reload()),this.$emit(t)},reload:function(){var t=this;this.isShow=!1,this.$nextTick((function(){t.isShow=!0}))}}}),i=o,r=(n("a139"),n("cba8")),l=Object(r["a"])(i,s,a,!1,null,"89d1d080",null);e["a"]=l.exports},"6cd07":function(t,e,n){"use strict";n("ce14")},"6ce4":function(t,e,n){"use strict";n("ed3c")},8501:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-drawer",{directives:[{name:"loading",rawName:"v-loading",value:t.result.loading,expression:"result.loading"}],ref:"drawer",attrs:{"before-close":t.handleClose,visible:t.showDialog,"with-header":!1,size:"100%","modal-append-to-body":!1},on:{"update:visible":function(e){t.showDialog=e}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("template-component-edit-header",{attrs:{template:t.template},on:{cancel:t.handleClose,save:t.handleSave}}),n("div",{staticClass:"container"},[n("el-aside",[n("div",{staticClass:"description"},[n("span",{staticClass:"title"},[t._v(t._s(t.$t("test_track.plan_view.component_library")))]),n("span",[t._v(t._s(t.$t("test_track.plan_view.component_library_tip")))])]),n("draggable",{staticClass:"dragArea list-group",attrs:{list:t.components,group:{name:"component",pull:"clone",put:!1},clone:t.clonePreview}},[n("transition-group",t._l(t.components,(function(e){return n("template-component-bar",{key:e,attrs:{component:t.componentMap.get(e)}})})),1)],1)],1),n("el-main",[n("draggable",{staticClass:"dragArea list-group",attrs:{list:t.previews,group:"component"},on:{change:t.change}},[n("transition-group",t._l(t.previews,(function(e){return n("div",{key:e.id,staticClass:"preview"},[n("template-component",{attrs:{"is-report-view":!1,"is-report":t.isReport,metric:t.metric,preview:e}}),n("i",{staticClass:"el-icon-error",on:{click:function(n){return t.handleDelete(e)}}})],1)})),0)],1)],1)],1)]}}])})},a=[],o=(n("bb13"),n("89a8"),n("b110"),n("fe35"),n("1a91"),n("d5ee"),n("10dd"),n("993f"),n("87bf"),n("cea3"),n("4c1e"),n("6370"),n("bbe2"),n("87d5"),n("3335")),i=n.n(o),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-button",{staticClass:"template-component"},[n("i",{staticClass:"el-icon-s-unfold"}),n("span",[t._v(t._s(t.component.name))]),"system"==t.component.type?n("el-tag",{attrs:{size:"mini",type:"success"}},[t._v(t._s(t.$t("commons.system")))]):t._e(),"custom"==t.component.type?n("el-tag",{attrs:{size:"mini"}},[t._v(t._s(t.$t("commons.custom")))]):t._e()],1)},l=[],c={name:"TemplateComponentBar",props:{component:{type:Object,default:function(){return{}}}}},p=c,u=(n("6cd07"),n("cba8")),m=Object(u["a"])(p,r,l,!1,null,"c97ad796",null),d=m.exports,h=n("9722"),f=(n("4abd"),n("495f")),_=n("0565"),b={name:"TestCaseReportTemplateEdit",components:{TemplateComponent:_["a"],TemplateComponentEditHeader:h["a"],TemplateComponentBar:d,draggable:i.a},data:function(){return{showDialog:!1,result:{},name:"",type:"edit",componentMap:new Map([[1,{name:this.$t("test_track.plan_view.base_info"),id:1,type:"system"}],[2,{name:this.$t("test_track.plan_view.test_result"),id:2,type:"system"}],[3,{name:this.$t("test_track.plan_view.result_distribution"),id:3,type:"system"}],[4,{name:this.$t("test_track.plan_view.failure_case"),id:4,type:"system"}],[5,{name:this.$t("test_track.plan_view.defect_list"),id:5,type:"system"}],[6,{name:this.$t("test_track.plan_view.custom_component"),id:6,type:"custom"}]]),components:[6],previews:[],template:{},isReport:!1}},props:{metric:{type:Object}},methods:{listenGoBack:function(){window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1))},goBack:function(){this.handleClose()},open:function(t,e){e&&(this.isReport=e),this.template={name:"",content:{components:[1,2,3,4,5,6],customComponent:new Map}},this.previews=[],this.components=[6],t?(this.type="edit",this.getTemplateById(t)):(this.type="add",this.initComponents()),this.showDialog=!0,this.listenGoBack()},initComponents:function(){var t=this;this.componentMap.forEach((function(e,n){t.template.content.components.indexOf(n)<0&&t.components.indexOf(n)<0&&t.components.push(n)})),this.template.content.components.forEach((function(e){var n=t.componentMap.get(e);if(n&&"custom"!=n.type)t.previews.push(n);else if(t.template.content.customComponent){var s=t.template.content.customComponent.get(e.toString());s&&t.previews.push({id:e,title:s.title,content:s.content})}}))},handleClose:function(){window.removeEventListener("popstate",this.goBack,!1),this.showDialog=!1},change:function(t){if(t.added){var e=t.added.element;if("system"==e.type)for(var n=0;n<this.components.length;n++)this.deleteComponentById(e.id)}},clonePreview:function(t){var e=this.componentMap.get(t),n=t;return"system"!=e.type&&(n=this.generateComponentId()),{id:n,name:e.name,type:e.type}},handleDelete:function(t){if(1!=this.previews.length){for(var e=0;e<this.previews.length;e++)if(this.previews[e].id==t.id){this.previews.splice(e,1),"system"==t.type&&this.components.push(t.id);break}}else this.$warning(this.$t("test_track.plan_view.delete_component_tip"))},generateComponentId:function(){return Date.parse(new Date)+Math.ceil(1e5*Math.random())},deleteComponentById:function(t){for(var e=0;e<this.components.length;e++)if(this.components[e]==t){this.components.splice(e,1);break}},getTemplateById:function(t){var e=this,n="/case/report/template/get/";this.isReport&&(n="/case/report/get/"),this.$get(n+t,(function(t){e.template=t.data,e.template.content=JSON.parse(t.data.content),e.template.content.customComponent&&(e.template.content.customComponent=Object(f["u"])(e.template.content.customComponent),e.template.startTime&&(e.metric.startTime=new Date(e.template.startTime)),e.template.endTime&&(e.metric.endTime=new Date(e.template.endTime))),e.initComponents()}))},handleSave:function(){var t=this,e=new RegExp("[`~!@#$^&*=|{}':;',<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]");if(null!=this.template.name&&""!=this.template.name)if(this.template.name.length>64)this.$warning(this.$t("commons.name")+this.$t("test_track.length_less_than")+"64");else if(e.test(this.template.name))this.$warning(this.$t("test_track.plan_view.template_special_characters"));else{var n={};this.buildParam(n);var s="/case/report/template/";this.isReport&&(s="/case/report/"),this.$post(s+this.type,n,(function(){t.$success(t.$t("commons.save_success")),t.handleClose(),t.$emit("refresh")}))}else this.$warning(this.$t("test_track.plan_view.input_template_name"))},buildParam:function(t){var e=this,n={components:[]};n.customComponent=new Map,this.previews.forEach((function(t){n.components.push(t.id),e.componentMap.get(t.id)||n.customComponent.set(t.id,{title:t.title,content:t.content})})),t.name=this.template.name,n.customComponent&&(n.customComponent=Object(f["w"])(n.customComponent)),t.content=JSON.stringify(n),"edit"==this.type?t.id=this.template.id:t.workspaceId=Object(f["j"])(),this.template.workspaceId&&(t.workspaceId=Object(f["j"])()),this.metric&&this.metric.startTime&&(t.startTime=this.metric.startTime.getTime()),this.metric&&this.metric.endTime&&(t.endTime=this.metric.endTime.getTime())}}},g=b,v=(n("6602"),Object(u["a"])(g,s,a,!1,null,"eeabc148",null));e["a"]=v.exports},"85e4":function(t,e,n){"use strict";n("2ccb")},9497:function(t,e,n){"use strict";n("eb34")},"95ad":function(t,e,n){"use strict";n("3f21")},9722:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-row",{staticClass:"head-bar",attrs:{type:"flex"}},[n("el-col",{attrs:{span:12}},[t.showEdit?n("div",{staticClass:"name-edit"},[n("el-input",{attrs:{placeholder:t.$t("test_track.plan_view.input_template_name")},model:{value:t.template[t.prop],callback:function(e){t.$set(t.template,t.prop,e)},expression:"template[prop]"}}),t.template[t.prop]?n("span",{staticClass:"title"},[t._v(t._s(t.template[t.prop]))]):n("span",{staticClass:"name-tip"},[t._v(t._s(t.$t("test_track.plan_view.input_template_name")))])],1):t._e()]),n("el-col",{staticClass:"head-right",attrs:{span:12}},[n("el-button",{attrs:{plain:"",size:"mini"},on:{click:t.handleCancel}},[t._v(t._s(t.$t("test_track.return")))]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleSave}},[t._v(t._s(t.$t("test_track.save")))])],1)],1)},a=[],o={name:"TemplateComponentEditHeader",data:function(){return{}},props:{template:{type:Object,default:function(){return{}}},prop:{type:String,default:function(){return"name"}},showEdit:{type:Boolean,default:function(){return!0}}},methods:{handleCancel:function(){this.$emit("cancel")},handleSave:function(){this.$emit("save")}}},i=o,r=(n("1e6b"),n("cba8")),l=Object(r["a"])(i,s,a,!1,null,"91dbcada",null);e["a"]=l.exports},a139:function(t,e,n){"use strict";n("4a98")},ac4b:function(t,e,n){},afcf:function(t,e,n){"use strict";n("b553")},b553:function(t,e,n){},bedb:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ms-container",[n("ms-main-container",[n("test-plan-report-list",{ref:"testPlanReportList"})],1)],1)},a=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.result.loading,expression:"result.loading"}],staticClass:"table-card",scopedSlots:t._u([{key:"header",fn:function(){return[n("ms-table-header",{attrs:{condition:t.condition,"show-create":!1},on:{"update:condition":function(e){t.condition=e},search:t.initTableData}})]},proxy:!0}])},[n("el-table",{ref:"testPlanReportTable",staticClass:"test-content adjust-table ms-select-all-fixed",attrs:{border:"",data:t.tableData,height:t.screenHeight,"row-key":"id"},on:{"select-all":t.handleSelectAll,select:t.handleSelect,"filter-change":t.filter,"sort-change":t.sort}},[n("el-table-column",{attrs:{width:"50",type:"selection"}}),n("ms-table-header-select-popover",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{"page-size":t.pageSize>t.total?t.total:t.pageSize,total:t.total,"select-data-counts":t.selectDataCounts,"table-data-count-in-page":t.tableData.length},on:{selectPageAll:function(e){return t.isSelectDataAll(!1)},selectAll:function(e){return t.isSelectDataAll(!0)}}}),n("el-table-column",{attrs:{width:"30",resizable:!1,align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("show-more-btn",{attrs:{"is-show":e.row.showMore,buttons:t.buttons,size:t.selectDataCounts}})]}}])}),n("el-table-column",{attrs:{"min-width":"300",prop:"name",label:t.$t("test_track.report.list.name"),"show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"testPlanName","min-width":"150",sortable:"",label:t.$t("test_track.report.list.test_plan"),"show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"creator",label:t.$t("test_track.report.list.creator"),"show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"createTime",sortable:"",label:t.$t("test_track.report.list.create_time"),"show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("timestampFormatDate")(e.row.createTime)))])]}}])}),n("el-table-column",{attrs:{prop:"triggerMode",label:t.$t("test_track.report.list.trigger_mode"),"show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(t){return[n("report-trigger-mode-item",{attrs:{"trigger-mode":t.row.triggerMode}})]}}])}),n("el-table-column",{attrs:{prop:"status",label:t.$t("commons.status")},scopedSlots:t._u([{key:"default",fn:function(t){return["RUNNING"==t.row.status?n("ms-tag",{attrs:{type:"success",effect:"plain",content:"Running"}}):"COMPLETED"==t.row.status||"SUCCESS"==t.row.status||"FAILED"==t.row.status?n("ms-tag",{attrs:{type:"info",effect:"plain",content:"Completed"}}):n("ms-tag",{attrs:{type:"effect",effect:"plain",content:t.row.status}})]}}])}),n("el-table-column",{attrs:{"min-width":"150",label:t.$t("commons.operating")},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("ms-table-operator-button",{attrs:{tip:t.$t("test_track.plan_view.view_report"),icon:"el-icon-document"},on:{exec:function(n){return t.openReport(e.row.id)}}}),n("ms-table-operator-button",{directives:[{name:"permission",rawName:"v-permission",value:["PROJECT_TRACK_REPORT:READ+DELETE"],expression:"['PROJECT_TRACK_REPORT:READ+DELETE']"}],attrs:{type:"danger",tip:t.$t("commons.delete"),icon:"el-icon-delete"},on:{exec:function(n){return t.handleDelete(e.row)}}})],1)]}}])})],1),n("ms-table-pagination",{attrs:{change:t.initTableData,"current-page":t.currentPage,"page-size":t.pageSize,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e}}}),n("test-plan-report-view",{ref:"testPlanReportView",on:{refresh:t.initTableData}})],1)},i=[],r=(n("89a8"),n("d25d"),n("b110"),n("fe35"),n("10dd"),n("8ea3"),n("e766"),n("87d5"),n("59d9")),l=n("10b9"),c=n("be8e"),p=n("1c98"),u=n("8852"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-drawer",{directives:[{name:"loading",rawName:"v-loading",value:t.result.loading,expression:"result.loading"}],ref:"drawer",attrs:{visible:t.showDialog,"with-header":!1,"modal-append-to-body":!1,size:"100%"},on:{"update:visible":function(e){t.showDialog=e}},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-row",{staticClass:"head-bar",attrs:{type:"flex"}},[n("el-col",{attrs:{span:12}},[n("div",{staticClass:"name-edit"},[n("el-button",{attrs:{plain:"",size:"mini",icon:"el-icon-back"},on:{click:t.handleClose}},[t._v(t._s(t.$t("test_track.return"))+" ")]),t._v("  "),n("span",{staticClass:"title"},[t._v(t._s(t.report.name))])],1)]),n("el-col",{staticClass:"head-right",attrs:{span:12}},[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["PROJECT_TRACK_REPORT:READ+EXPORT"],expression:"['PROJECT_TRACK_REPORT:READ+EXPORT']"}],attrs:{disabled:!t.isTestManagerOrTestUser,plain:"",size:"mini"},on:{click:function(e){return t.handleExport(t.report.name)}}},[t._v(" "+t._s(t.$t("test_track.plan_view.export_report"))+" ")])],1)],1),n("div",{ref:"resume",staticClass:"container",attrs:{id:"app"}},[n("el-main",t._l(t.previews,(function(e,s){return n("div",{key:e.id},[n("template-component",{ref:"templateComponent",refInFor:!0,attrs:{source:t.source,isReportView:!0,metric:t.metric,planId:t.planId,preview:e,index:s}})],1)})),0)],1)]}}])}),t.reportExportVisible?n("ms-test-plan-report-export",{attrs:{id:"testCaseReportExport",title:t.report.name,metric:t.metric,previews:t.previews}}):t._e(),n("test-case-report-template-edit",{ref:"templateEdit",attrs:{metric:t.metric},on:{refresh:t.getReport}})],1)},d=[],h=(n("bb13"),n("1a91"),n("d5ee"),n("495f")),f=n("b826"),_=n("6147"),b=n("4b7c"),g=n("ce2d"),v=n("8501"),w=n("0565"),C=n("156b"),y=n.n(C),T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ms-report-export-template",{attrs:{title:t.title,type:t.$t("report.test_plan_report")}},t._l(t.previews,(function(e,s){return n("div",{key:e.id},[n("template-component",{ref:"templateComponent",refInFor:!0,attrs:{isReportView:!0,metric:t.metric,preview:e,index:s}})],1)})),0)},$=[],k=n("00f1"),R=n("cd3e"),E={name:"MsTestPlanReportExport",components:{MsReportTitle:R["a"],TemplateComponent:w["a"],MsReportExportTemplate:k["a"]},props:["previews","title","metric"]},P=E,S=(n("9497"),n("cba8")),x=Object(S["a"])(P,T,$,!1,null,"7fe8e045",null),O=x.exports,D={name:"TestPlanReportView",components:{MsTestPlanReportExport:O,TemplateComponent:w["a"],TestCaseReportTemplateEdit:v["a"],RichTextComponent:g["a"],TestResultComponent:b["a"],TestResultChartComponent:_["a"],BaseInfoComponent:f["a"]},data:function(){return{result:{},imgUrl:"",showDialog:!1,previews:[],report:{},reportId:"",source:"ReportView",reportComponents:[1,3,4],metric:{},planId:"",reportExportVisible:!1,componentMap:new Map([[1,{name:this.$t("test_track.plan_view.base_info"),id:1,type:"system"}],[2,{name:this.$t("test_track.plan_view.test_result"),id:2,type:"system"}],[3,{name:this.$t("test_track.plan_view.result_distribution"),id:3,type:"system"}],[4,{name:this.$t("test_track.plan_view.failure_case"),id:4,type:"system"}],[5,{name:this.$t("test_track.plan_view.defect_list"),id:5,type:"system"}],[6,{name:this.$t("test_track.plan_view.custom_component"),id:6,type:"custom"}]]),isTestManagerOrTestUser:!1}},mounted:function(){this.isTestManagerOrTestUser=!0},watch:{reportComponents:function(){this.initPreviews()}},methods:{listenGoBack:function(){window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1))},goBack:function(){this.handleClose()},open:function(t){this.reportId=t,this.getReport(),this.showDialog=!0,this.listenGoBack()},getReport:function(){this.getMetric(),this.initPreviews()},initPreviews:function(){var t=this;this.previews=[],this.reportComponents.forEach((function(e){var n=t.componentMap.get(e);if(n&&"custom"!=n.type)t.previews.push(n);else if(t.report.content.customComponent){var s=t.report.content.customComponent.get(e.toString());s&&t.previews.push({id:e,title:s.title,content:s.content})}}))},handleClose:function(){window.removeEventListener("popstate",this.goBack,!1),this.$emit("refresh"),this.showDialog=!1},getMetric:function(){var t=this;this.result=this.$get("/test/plan/report/getMetric/"+this.reportId,(function(e){t.metric=e.data;var n=e.data.reportComponents;t.planId=e.data.testPlanId,t.report.name=e.data.name,t.report.startTime=e.data.startTime,t.report.endTime=e.data.endTime,t.reportComponents=null===n||""===n?[1,3,4]:JSON.parse(n),t.metric.failureTestCases||(t.metric.failureTestCases=[]),t.metric.executeResult||(t.metric.executeResult=[]),t.metric.moduleExecuteResult||(t.metric.moduleExecuteResult=[]),t.metric.issues||(t.metric.issues=[]),t.report.startTime&&(t.metric.startTime=new Date(t.report.startTime)),t.report.endTime&&(t.metric.endTime=new Date(t.report.endTime))}))},handleExport:function(t){this.result.loading=!0,this.reportExportVisible=!0;var e=this.exportReportReset;this.$nextTick((function(){setTimeout((function(){y()(document.getElementById("testCaseReportExport"),{scale:2}).then((function(n){Object(h["d"])(t,[n]),e()}))}),1e3)}))},exportReportReset:function(){this.reportExportVisible=!1,this.result.loading=!1}}},M=D,j=(n("6ce4"),Object(S["a"])(M,m,d,!1,null,"21320ab9",null)),A=j.exports,I=n("4191"),B=n("aa18"),z=n("eab7"),L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-table-column",{attrs:{width:"1",resizable:!1,align:"center"}},[n("el-dropdown",{attrs:{slot:"header"},slot:"header"},[n("span",{staticClass:"el-dropdown-link"},[n("i",{staticClass:"el-icon-arrow-down"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{nativeOn:{click:function(e){return e.stopPropagation(),t.$emit("selectAll")}}},[t._v(" "+t._s(t.$t("api_test.batch_menus.select_all_data",[t.total]))+" ")]),n("el-dropdown-item",{nativeOn:{click:function(e){return e.stopPropagation(),t.$emit("selectPageAll")}}},[t._v(" "+t._s(t.$t("api_test.batch_menus.select_show_data",[t.pageSize]))+" ")])],1)],1)],1)},N=[],F={name:"MsTableSelectAll",props:["total","pageSize"]},U=F,H=Object(S["a"])(U,L,N,!1,null,"72e25fac",null),V=H.exports,J=n("e077"),K=n("665c"),G={name:"TestPlanReportList",components:{MsTableHeaderSelectPopover:K["a"],TestPlanReportView:A,MsTableOperator:p["a"],MsTableOperatorButton:c["a"],MsTableHeader:l["a"],MsTablePagination:r["a"],ReportTriggerModeItem:I["a"],MsTag:B["a"],ShowMoreBtn:z["a"],MsTableSelectAll:V},data:function(){return{result:{},enableDeleteTip:!1,tableHeaderKey:"TRACK_REPORT_TABLE",queryPath:"/test/plan/report/list",condition:{components:u["j"]},currentPage:1,pageSize:10,isTestManagerOrTestUser:!1,selectRows:new Set,screenHeight:"calc(100vh - 200px)",total:0,tableData:[],statusFilters:[{text:this.$t("test_track.plan.plan_status_prepare"),value:"Prepare"},{text:this.$t("test_track.plan.plan_status_running"),value:"Underway"},{text:this.$t("test_track.plan.plan_status_completed"),value:"Completed"}],stageFilters:[{text:this.$t("test_track.plan.smoke_test"),value:"smoke"},{text:this.$t("test_track.plan.system_test"),value:"system"},{text:this.$t("test_track.plan.regression_test"),value:"regression"}],buttons:[{name:this.$t("api_test.definition.request.batch_delete"),handleClick:this.handleDeleteBatch,permission:["PROJECT_TRACK_REPORT:READ+DELETE"]}],selectDataCounts:0}},watch:{$route:function(t,e){}},activated:function(){this.components=u["j"]},created:function(){this.projectId=this.$route.params.projectId,this.projectId||(this.projectId=Object(h["g"])()),this.isTestManagerOrTestUser=!0,this.initTableData()},methods:{initTableData:function(){var t=this;Object(J["w"])(this.condition,this.condition.selectAll);var e=this.getSortField();e&&(this.condition.orders=e),this.selectRows=new Set,this.planId&&(this.condition.planId=this.planId),this.selectNodeIds&&this.selectNodeIds.length>0&&(this.condition.nodeIds=this.selectNodeIds),this.projectId&&(this.condition.projectId=Object(h["g"])(),this.result=this.$post(this.buildPagePath(this.queryPath),this.condition,(function(e){var n=e.data;t.total=n.itemCount,t.tableData=n.listObject,t.$refs.testPlanReportTable,t.$nextTick((function(){Object(J["g"])(t,t.condition,t.tableData,t.$refs.testPlanReportTable,t.selectRows)}))})))},buildPagePath:function(t){return t+"/"+this.currentPage+"/"+this.pageSize},handleSelect:function(t,e){Object(J["b"])(this,t,e,this.selectRows),Object(J["A"])(this.tableData,this.condition,this.selectRows),this.selectDataCounts=Object(J["u"])(this.condition,this.total,this.selectRows)},handleSelectAll:function(t){Object(J["c"])(this,t,this.tableData,this.selectRows),Object(J["A"])(this.tableData,this.condition,this.selectRows),this.selectDataCounts=Object(J["u"])(this.condition,this.total,this.selectRows)},handleDelete:function(t){var e=this;this.$alert(this.$t("report.delete_confirm")+" "+t.name+" ？","",{confirmButtonText:this.$t("commons.confirm"),callback:function(n){if("confirm"===n){var s=[t.id];e.$post("/test/plan/report/delete/",s,(function(){e.$success(e.$t("commons.delete_success")),e.initTableData()}))}}})},handleDeleteBatch:function(){var t=this;this.$alert(this.$t("report.delete_batch_confirm")+"  ？","",{confirmButtonText:this.$t("commons.confirm"),callback:function(e){if("confirm"===e){var n={},s=Array.from(t.selectRows).map((function(t){return t.id}));n.dataIds=s,n.projectId=t.projectId,n.selectAllDate=t.condition.selectAll,n.unSelectIds=t.condition.unSelection,n=Object.assign(n,t.condition),t.$post("/test/plan/report/deleteBatchByParams/",n,(function(){t.$success(t.$t("commons.delete_success")),t.initTableData(),t.selectRows.clear()}))}}})},getIds:function(t){var e=Array.from(t),n=e.map((function(t){return t.id}));return n},filter:function(t){Object(J["a"])(t,this.condition),this.initTableData()},sort:function(t){this.condition.orders&&(this.condition.orders=[]),Object(J["d"])(t,this.condition),this.saveSortField(this.tableHeaderKey,this.condition.orders),this.initTableData()},openReport:function(t){t&&this.$refs.testPlanReportView.open(t)},isSelectDataAll:function(t){this.condition.selectAll=t,Object(J["B"])(this.$refs.testPlanReportTable,this.tableData,this.selectRows),Object(J["c"])(this,this.tableData,this.tableData,this.selectRows),this.condition.unSelectIds=[],this.selectDataCounts=Object(J["u"])(this.condition,this.total,this.selectRows)},saveSortField:function(t,e){Object(J["z"])(t,JSON.stringify(e))},getSortField:function(){var t=Object(J["r"])(this.tableHeaderKey),e=null;if(t)try{e=JSON.parse(t)}catch(n){return null}return e}}},q=G,X=(n("85e4"),Object(S["a"])(q,o,i,!1,null,"73086c32",null)),Q=X.exports,W=n("1b11"),Y=n("489a"),Z={name:"TestPlanReport",components:{MsMainContainer:Y["a"],MsContainer:W["a"],TestPlanReportList:Q},data:function(){return{}},activated:function(){this.refreshTestPlanList()},mounted:function(){this.refreshTestPlanList()},watch:{$route:function(t,e){}},methods:{refreshTestPlanList:function(){this.$refs.testPlanReportList.condition={},this.$refs.testPlanReportList.initTableData()}}},tt=Z,et=Object(S["a"])(tt,s,a,!1,null,"6b226aad",null);e["default"]=et.exports},cd3e:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"clearfix report-title"},[n("div",{staticClass:"report-left"},[n("div",{staticClass:"title"},[t._v(" 【"+t._s(t.type)+"】- "+t._s(t.title)+" ")]),n("div",[n("span",{staticClass:"time"},[t._v(t._s(t._f("timestampFormatDate")(new Date)))])])]),t._m(0)])},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report-right"},[s("img",{staticClass:"logo",attrs:{src:n("5f11")}})])}],o={name:"MsReportTitle",props:{title:String,type:String},data:function(){return{}}},i=o,r=(n("defb"),n("cba8")),l=Object(r["a"])(i,s,a,!1,null,"41c9b43d",null);e["a"]=l.exports},ce14:function(t,e,n){},dd13:function(t,e,n){},ddf4:function(t,e,n){"use strict";n("344e")},defb:function(t,e,n){"use strict";n("dd13")},eab7:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isShow?n("div",[n("el-dropdown",{attrs:{placement:"bottom",trigger:"click",size:"medium"}},[n("div",{staticClass:"show-more-btn",on:{click:function(t){t.stopPropagation()}}},[n("el-tooltip",{attrs:{"popper-class":"batch-popper",value:!t.hasShowed,effect:"dark",content:t.$t("test_track.case.batch_operate"),placement:"top-start"}},[n("i",{staticClass:"el-icon-more ms-icon-more table-more-icon"})])],1),n("el-dropdown-menu",{staticClass:"dropdown-menu-class",attrs:{slot:"dropdown"},slot:"dropdown"},[n("div",{staticClass:"show-more-btn-title"},[t._v(t._s(t.$t("test_track.case.batch_handle",[t.size])))]),t._l(t.buttons,(function(e,s){return n("el-dropdown-item",{key:s,attrs:{disabled:t.isDisable(e)},nativeOn:{click:function(n){return n.stopPropagation(),t.click(e)}}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1)],1):t._e()},a=[],o=n("045d"),i=(n("51b3"),n("993f"),n("495f")),r={name:"ShowMoreBtn",data:function(){return{disabled:!1}},props:{isShow:{type:Boolean,default:!1},buttons:Array,row:Object,size:Number,hasShowed:Boolean},created:function(){this.trashEnable&&this.buttons.splice(1,1)},methods:{click:function(t){t.handleClick instanceof Function&&t.handleClick()},isDisable:function(t){return!!(t.permissions&&t.permissions.length>0)&&!i["r"].apply(void 0,Object(o["a"])(t.permissions))}}},l=r,c=(n("afcf"),n("ddf4"),n("cba8")),p=Object(c["a"])(l,s,a,!1,null,"0c4d25dc",null);e["a"]=p.exports},eb34:function(t,e,n){},ed3c:function(t,e,n){}}]);