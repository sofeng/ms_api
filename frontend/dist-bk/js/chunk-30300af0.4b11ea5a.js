(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30300af0"],{"6ebc":function(e,t,s){"use strict";s("a6da")},a6da:function(e,t,s){},f9d4:function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.result.loading,expression:"result.loading"}]},[s("el-card",{staticClass:"table-card",scopedSlots:e._u([{key:"header",fn:function(){return[s("ms-table-header",{attrs:{"create-permission":["WORKSPACE_USER:READ+CREATE"],condition:e.condition,"create-tip":e.$t("member.create"),title:e.$t("commons.member")},on:{"update:condition":function(t){e.condition=t},search:e.initTableData,create:e.create}})]},proxy:!0}])},[s("el-table",{ref:"userTable",staticClass:"adjust-table",staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData,height:e.screenHeight}},[s("el-table-column",{attrs:{prop:"id",label:"ID"}}),s("el-table-column",{attrs:{prop:"name",label:e.$t("commons.username")}}),s("el-table-column",{attrs:{prop:"email",label:e.$t("commons.email")}}),s("el-table-column",{attrs:{prop:"phone",label:e.$t("commons.phone")}}),s("el-table-column",{attrs:{prop:"groups",label:e.$t("commons.group"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("ms-roles-tag",{attrs:{roles:e.row.groups,type:"success"}})]}}])}),s("el-table-column",{attrs:{label:e.$t("commons.operating")},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("ms-table-operator",{attrs:{"edit-permission":["WORKSPACE_USER:READ+EDIT"],"delete-permission":["WORKSPACE_USER:READ+DELETE"],tip2:e.$t("commons.remove")},on:{editClick:function(s){return e.edit(t.row)},deleteClick:function(s){return e.del(t.row)}}})],1)]}}])})],1),s("ms-table-pagination",{attrs:{change:e.initTableData,"current-page":e.currentPage,"page-size":e.pageSize,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1),s("add-member",{ref:"addMember",attrs:{"group-type":"WORKSPACE","group-scope-id":e.orgId},on:{submit:e.submitForm}}),s("el-dialog",{attrs:{"close-on-click-modal":!1,title:e.$t("member.modify"),visible:e.updateVisible,width:"30%","destroy-on-close":!0},on:{"update:visible":function(t){e.updateVisible=t},close:e.handleClose},scopedSlots:e._u([{key:"footer",fn:function(){return[s("ms-dialog-footer",{on:{cancel:function(t){e.updateVisible=!1},confirm:function(t){return e.updateWorkspaceMember("updateUserForm")}}})]},proxy:!0}])},[s("el-form",{ref:"updateUserForm",attrs:{model:e.form,"label-position":"right","label-width":"100px",size:"small"}},[s("el-form-item",{attrs:{label:"ID",prop:"id"}},[s("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),s("el-form-item",{attrs:{label:e.$t("commons.username"),prop:"name"}},[s("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),s("el-form-item",{attrs:{label:e.$t("commons.email"),prop:"email"}},[s("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),s("el-form-item",{attrs:{label:e.$t("commons.phone"),prop:"phone"}},[s("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),s("el-form-item",{attrs:{label:e.$t("commons.group"),prop:"groupIds",rules:{required:!0,message:e.$t("group.please_select_group"),trigger:"change"}}},[s("el-select",{staticClass:"select-width",attrs:{multiple:"",placeholder:e.$t("group.please_select_group")},model:{value:e.form.groupIds,callback:function(t){e.$set(e.form,"groupIds",t)},expression:"form.groupIds"}},e._l(e.form.allgroups,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),s("user-cascader",{ref:"cascaderDialog",attrs:{lable:e.batchAddLable,title:e.batchAddTitle},on:{confirm:e.cascaderConfirm}})],1)},a=[],i=(s("89a8"),s("d25d"),s("b110"),s("fe35"),s("10dd"),s("1a91"),s("8ea3"),s("5a05"),s("e766"),s("978f")),r=s("59d9"),n=s("10b9"),c=s("2edc"),l=s("1c98"),u=s("15bc"),d=s("495f"),m=s("665c"),h=s("e077"),p=s("6541"),f=s("eab7"),b=s("4abd"),g=s("bcc4"),$={name:"MsMember",components:{AddMember:g["a"],MsCreateBox:i["a"],MsTablePagination:r["a"],MsTableHeader:n["a"],MsRolesTag:c["a"],MsTableOperator:l["a"],MsDialogFooter:u["a"],MsTableHeaderSelectPopover:m["a"],UserCascader:p["a"],ShowMoreBtn:f["a"]},data:function(){return{result:{},form:{},createVisible:!1,updateVisible:!1,queryPath:"/user/ws/member/list",condition:{},tableData:[],userList:[],rules:{userIds:[{required:!0,message:this.$t("member.please_choose_member"),trigger:["blur"]}],groupIds:[{required:!0,message:this.$t("group.please_select_group"),trigger:["blur"]}]},screenHeight:"calc(100vh - 195px)",multipleSelection:[],currentPage:1,pageSize:10,total:0,selectDataCounts:0,batchAddLable:this.$t("project.please_choose_workspace"),batchAddTitle:this.$t("project.batch_choose_workspace"),selectRows:new Set,referenced:!1,batchAddUserRoleOptions:[],buttons:[]}},computed:{orgId:function(){return Object(d["f"])()}},activated:function(){this.initTableData()},methods:{currentUser:function(){return Object(d["h"])()},initTableData:function(){var e=this;if(null===Object(d["j"])())return!1;this.loading=!0;var t={name:this.condition.name,workspaceId:Object(d["j"])()};this.result=this.$post(this.buildPagePath(this.queryPath),t,(function(t){var s=t.data;e.tableData=s.listObject;for(var o="/user/group/list/ws/"+Object(d["j"])(),a=function(t){e.$get(o+"/"+encodeURIComponent(e.tableData[t].id),(function(s){var o=s.data;e.$set(e.tableData[t],"groups",o)}))},i=0;i<e.tableData.length;i++)a(i);e.total=s.itemCount,e.$nextTick((function(){this.checkTableRowIsSelect()}))}))},checkTableRowIsSelect:function(){var e=this;if(this.condition.selectAll){var t=this.condition.unSelectIds;this.tableData.forEach((function(s){t.indexOf(s.id)<0?(e.$refs.userTable.toggleRowSelection(s,!0),e.selectRows.has(s)||(e.$set(s,"showMore",!0),e.selectRows.add(s))):e.selectRows.has(s)&&(e.$set(s,"showMore",!1),e.selectRows.delete(s))}))}},buildPagePath:function(e){return e+"/"+this.currentPage+"/"+this.pageSize},handleClose:function(){this.form={},this.createVisible=!1,this.updateVisible=!1,Object(d["z"])(this.handleClose)},del:function(e){var t=this;this.$confirm(this.$t("member.remove_member"),"",{confirmButtonText:this.$t("commons.confirm"),cancelButtonText:this.$t("commons.cancel"),type:"warning"}).then((function(){t.result=t.$get("/user/ws/member/delete/"+Object(d["j"])()+"/"+encodeURIComponent(e.id),(function(){t.$success(t.$t("commons.remove_success")),t.initTableData()}))})).catch((function(){t.$info(t.$t("commons.remove_cancel"))}))},edit:function(e){var t=this;this.updateVisible=!0,this.form=Object.assign({},e);var s=this.form.groups.map((function(e){return e.id}));this.result=this.$post("/user/group/list",{type:b["l"],resourceId:Object(d["f"])()},(function(e){t.$set(t.form,"allgroups",e.data)})),this.$set(this.form,"groupIds",s),Object(d["v"])(this.handleClose)},updateWorkspaceMember:function(e){var t=this,s={id:this.form.id,name:this.form.name,email:this.form.email,phone:this.form.phone,groupIds:this.form.groupIds,workspaceId:Object(d["j"])()};this.$refs[e].validate((function(e){e&&(t.result=t.$post("/workspace/member/update",s,(function(){t.$success(t.$t("commons.modify_success")),t.updateVisible=!1,t.initTableData()})))}))},create:function(){var e=Object(d["j"])();if("undefined"==typeof e||null==e||""==e)return this.$warning(this.$t("workspace.please_select_a_workspace_first")),!1;this.$refs.addMember.open(),Object(d["v"])(this.handleClose)},submitForm:function(e){var t=this;e["workspaceId"]=Object(d["j"])(),this.result=this.$post("user/ws/member/add",e,(function(){t.$success(t.$t("commons.save_success")),t.initTableData(),t.selectRows.clear(),t.$refs.addMember.close()}))},querySearch:function(e,t){var s=this.userList,o=e?s.filter(this.createFilter(e)):s;t(o)},createFilter:function(e){return function(t){return 0===t.email.indexOf(e.toLowerCase())||0===t.id.indexOf(e.toLowerCase())}},initRoleBatchProcessDataStruct:function(e){var t=this,s=Object(d["f"])();this.$get("/user/getWorkspaceUserRoleDataStruct/"+s,(function(s){t.batchAddUserRoleOptions=s.data,e&&t.$refs.cascaderDialog.open("ADD_USER_ROLE",t.batchAddUserRoleOptions)}))},handleSelectAll:function(e){Object(h["c"])(this,e,this.tableData,this.selectRows,this.condition),Object(h["A"])(this.tableData,this.condition,this.selectRows),this.selectDataCounts=Object(h["u"])(this.condition,this.total,this.selectRows),this.$emit("selection",e)},handleSelect:function(e,t){Object(h["b"])(this,e,t,this.selectRows),Object(h["A"])(this.tableData,this.condition,this.selectRows),this.selectDataCounts=Object(h["u"])(this.condition,this.total,this.selectRows),this.$emit("selection",e),this.$set(this.form,"userId",e.id)},isSelectDataAll:function(e){this.condition.selectAll=e,Object(h["A"])(this.tableData,this.condition,this.selectRows),this.selectDataCounts=Object(h["u"])(this.condition,this.total,this.selectRows),Object(h["B"])(this.$refs.userTable,this.tableData,this.selectRows)},addUserRoleBatch:function(){0==this.batchAddUserRoleOptions.length?this.initRoleBatchProcessDataStruct(!0):this.$refs.cascaderDialog.open("ADD_USER_ROLE",this.batchAddUserRoleOptions)},cascaderConfirm:function(e,t){var s=this;0==t.length&&this.$success(this.$t("commons.modify_success"));var o={};o=this.buildBatchParam(o),o.organizationId=Object(d["f"])(),o.batchType=e,o.batchProcessValue=t,this.$post("/user/special/batchProcessUserInfo",o,(function(){s.$success(s.$t("commons.modify_success")),s.initTableData(),s.$refs.cascaderDialog.close()}))},buildBatchParam:function(e){return e.ids=Array.from(this.selectRows).map((function(e){return e.id})),e.projectId=Object(d["g"])(),e.condition=this.condition,e}}},w=$,R=(s("6ebc"),s("cba8")),D=Object(R["a"])(w,o,a,!1,null,"f4403586",null);t["default"]=D.exports}}]);