(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-798a5c1a"],{"0022":function(e,t,s){"use strict";s("5ba0")},"218d":function(e,t,s){"use strict";s("f4d0")},"5ba0":function(e,t,s){},"66e9":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"6df5":function(e,t,s){"use strict";var r=s("e3f7"),a=s("9dd2"),i=s("25ef"),o=s("8e74"),l=s("66e9"),n=s("3ffc"),c=s("ecf4"),u=s("bacb");a("search",(function(e,t,s){return[function(t){var s=o(this),a=void 0==t?void 0:c(t,e);return a?r(a,t,s):new RegExp(t)[e](n(s))},function(e){var r=i(this),a=n(e),o=s(t,r,a);if(o.done)return o.value;var c=r.lastIndex;l(c,0)||(r.lastIndex=0);var d=u(r,a);return l(r.lastIndex,c)||(r.lastIndex=c),null===d?-1:d.index}]}))},a173:function(e,t,s){},cb6b:function(e,t,s){"use strict";s("d054")},ccff:function(e,t,s){"use strict";s("a173")},d054:function(e,t,s){},e46e:function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return a}));var r="^1(3|4|5|6|7|8|9)\\d{9}$",a="^[a-zA-Z0-9_._-]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$"},e4aa:function(e,t,s){"use strict";s("e871")},e5a9:function(e,t,s){"use strict";s.d(t,"d",(function(){return a})),s.d(t,"c",(function(){return i})),s.d(t,"b",(function(){return o})),s.d(t,"f",(function(){return l})),s.d(t,"e",(function(){return n})),s.d(t,"i",(function(){return c})),s.d(t,"j",(function(){return u})),s.d(t,"g",(function(){return d})),s.d(t,"a",(function(){return p})),s.d(t,"k",(function(){return m})),s.d(t,"h",(function(){return f}));var r=s("0692"),a=[{value:"input",text:"输入框"},{value:"textarea",text:"文本框"},{value:"select",text:"单选下拉列表"},{value:"multipleSelect",text:"多选下拉列表"},{value:"radio",text:"单选框"},{value:"checkbox",text:"多选框"},{value:"member",text:"单选成员"},{value:"multipleMember",text:"多选成员"},{value:"data",text:"日期"},{value:"int",text:"整型"},{value:"float",text:"浮点型"}],i=[{value:"TEST_CASE",text:"用例模板"},{value:"ISSUE",text:"缺陷模板"}],o=[{value:"functional",text:"功能用例"}],l=[{value:"metersphere",text:"Metersphere"},{value:"Jira",text:"JIRA"},{value:"Tapd",text:"Tapd"},{value:"Zentao",text:"禅道"},{value:"AzureDevops",text:"Azure Devops"}],n={input:"输入框",textarea:"文本框",select:"单选下拉列表",multipleSelect:"多选下拉列表",radio:"单选框",checkbox:"多选框",member:"单选成员",multipleMember:"多选成员",data:"日期",int:"整型",float:"浮点型"},c={ISSUE:"缺陷模板",TEST_CASE:"用例模板"},u={"用例状态":"custom_field.case_status","责任人":"custom_field.case_maintainer","用例等级":"custom_field.case_priority","创建人":"custom_field.issue_creator","处理人":"custom_field.issue_processor","状态":"custom_field.issue_status","严重程度":"custom_field.issue_severity"},d={new:"新建",closed:"已关闭",resolved:"已解决",active:"激活",delete:"已删除"},p={LEVEL_FILTERS:[{text:"P0",value:"P0"},{text:"P1",value:"P1"},{text:"P2",value:"P2"},{text:"P3",value:"P3"}],RESULT_FILTERS:[{text:"Fail",value:"Fail"},{text:"Success",value:"Success"}],STATUS_FILTERS:[{text:r["default"].t("test_track.plan.plan_status_prepare"),value:"Prepare"},{text:r["default"].t("test_track.plan.plan_status_running"),value:"Underway"},{text:r["default"].t("test_track.plan.plan_status_completed"),value:"Completed"},{text:r["default"].t("test_track.plan.plan_status_trash"),value:"Trash"}]},m={SYSTEM:"系统",ORGANIZATION:"组织",WORKSPACE:"工作空间",PROJECT:"项目"},f={TRACK:"测试跟踪",API:"接口测试",PERFORMANCE:"性能测试",REPORT:"报告统计"}},e871:function(e,t,s){},e99a:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.result.loading,expression:"result.loading"}]},[s("el-card",{staticClass:"table-card",scopedSlots:e._u([{key:"header",fn:function(){return[s("ms-table-header",{attrs:{"create-permission":["SYSTEM_USER:READ+CREATE"],condition:e.condition,"show-import":!0,"import-tip":e.$t("commons.import_user"),"create-tip":e.$t("user.create"),title:e.$t("commons.user")},on:{"update:condition":function(t){e.condition=t},search:e.search,import:e.importUserDialogOpen,create:e.create}})]},proxy:!0}])},[s("el-table",{ref:"userTable",staticClass:"adjust-table ms-select-all-fixed",staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData,height:e.screenHeight},on:{"select-all":e.handleSelectAll,select:e.handleSelect}},[s("el-table-column",{attrs:{type:"selection",width:"50"}}),s("ms-table-header-select-popover",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{"page-size":e.pageSize>e.total?e.total:e.pageSize,total:e.total,"select-data-counts":e.selectDataCounts,"table-data-count-in-page":e.tableData.length},on:{selectPageAll:function(t){return e.isSelectDataAll(!1)},selectAll:function(t){return e.isSelectDataAll(!0)}}}),e.referenced?e._e():s("el-table-column",{attrs:{width:"30","min-width":"30",resizable:!1,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("show-more-btn",{attrs:{"is-show":t.row.showMore,buttons:e.buttons,size:e.selectDataCounts}})]}}],null,!1,3542939016)}),s("el-table-column",{attrs:{prop:"id",label:"ID"}}),s("el-table-column",{attrs:{prop:"name",label:e.$t("commons.name"),width:"200"}}),s("el-table-column",{attrs:{label:e.$t("commons.group"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("ms-roles-tag",{attrs:{roles:e.row.roles}})]}}])}),s("el-table-column",{attrs:{prop:"email",label:e.$t("commons.email")}}),s("el-table-column",{attrs:{prop:"status",label:e.$t("commons.status"),width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{disabled:e.currentUserId===t.row.id,"inactive-color":"#DCDFE6","active-value":"1","inactive-value":"0"},on:{change:function(s){return e.changeSwitch(t.row)}},model:{value:t.row.status,callback:function(s){e.$set(t.row,"status",s)},expression:"scope.row.status"}})]}}])}),s("el-table-column",{attrs:{prop:"createTime",label:e.$t("commons.create_time")},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e._f("timestampFormatDate")(t.row.createTime)))])]}}])}),s("el-table-column",{attrs:{prop:"source",label:e.$t("user.source")}}),s("el-table-column",{attrs:{label:e.$t("commons.operating"),"min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("ms-table-operator",{attrs:{"edit-permission":["SYSTEM_USER:READ+EDIT"],"delete-permission":["SYSTEM_USER:READ+DELETE"]},on:{editClick:function(s){return e.edit(t.row)},deleteClick:function(s){return e.del(t.row)}},scopedSlots:e._u([{key:"behind",fn:function(){return[t.row.isLocalUser?s("ms-table-operator-button",{directives:[{name:"permission",rawName:"v-permission",value:["SYSTEM_USER:READ+EDIT_PASSWORD"],expression:"['SYSTEM_USER:READ+EDIT_PASSWORD']"}],attrs:{tip:e.$t("member.edit_password"),icon:"el-icon-s-tools",type:"success"},on:{exec:function(s){return e.editPassword(t.row)}}}):e._e()]},proxy:!0}],null,!0)})],1)]}}])})],1),s("ms-table-pagination",{attrs:{change:e.search,"current-page":e.currentPage,"page-size":e.pageSize,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1),s("el-dialog",{attrs:{"close-on-click-modal":!1,title:e.$t("member.edit_password"),visible:e.editPasswordVisible,width:"30%","destroy-on-close":!0,left:""},on:{"update:visible":function(t){e.editPasswordVisible=t},close:e.handleClose}},[s("el-form",{ref:"editPasswordForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"label-position":"right","label-width":"100px",size:"small",rules:e.rule}},[s("el-form-item",{attrs:{label:e.$t("member.new_password"),prop:"newpassword"}},[s("el-input",{attrs:{type:"password",autocomplete:"off","show-password":""},model:{value:e.ruleForm.newpassword,callback:function(t){e.$set(e.ruleForm,"newpassword",t)},expression:"ruleForm.newpassword"}})],1),s("el-form-item",{attrs:{label:e.$t("member.repeat_password"),prop:"confirmpassword"}},[s("el-input",{attrs:{type:"password",autocomplete:"off","show-password":""},model:{value:e.ruleForm.confirmpassword,callback:function(t){e.$set(e.ruleForm,"confirmpassword",t)},expression:"ruleForm.confirmpassword"}})],1),s("el-form-item",[s("el-input",{staticStyle:{display:"none"},attrs:{autocomplete:"off",disabled:!0},model:{value:e.ruleForm.id,callback:function(t){e.$set(e.ruleForm,"id",t)},expression:"ruleForm.id"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("ms-dialog-footer",{on:{cancel:function(t){e.editPasswordVisible=!1},confirm:function(t){return e.editUserPassword("editPasswordForm")}}})],1)],1),s("user-import",{ref:"userImportDialog",on:{refreshAll:e.search}}),s("project-cascader",{ref:"cascaderDialog",attrs:{title:e.batchAddTitle},on:{confirm:e.cascaderConfirm}}),s("group-cascader",{ref:"groupCascaderDialog",attrs:{title:e.$t("user.add_user_group_batch")},on:{confirm:e.cascaderConfirm}}),s("edit-user",{ref:"editUser",on:{refresh:e.search}})],1)},a=[],i=(s("8fec"),s("89a8"),s("d25d"),s("b110"),s("fe35"),s("4c1e"),s("6df5"),s("1a91"),s("8ea3"),s("e766"),s("978f")),o=s("59d9"),l=s("10b9"),n=s("1c98"),c=s("15bc"),u=s("be8e"),d=s("495f"),p=s("2edc"),m=s("e46e"),f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{staticClass:"user-import",attrs:{title:e.$t("commons.import_user"),visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[s("el-row",[s("el-alert",{attrs:{title:"用户组只支持系统默认用户组",type:"info","show-icon":"",closable:!1}})],1),s("el-row",[s("el-link",{staticClass:"download-template",attrs:{type:"primary"},on:{click:e.downloadTemplate}},[e._v(e._s(e.$t("test_track.case.import.download_template"))+" ")])],1),s("el-row",[s("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.result.loading,expression:"result.loading"}],staticClass:"upload-demo",staticStyle:{width:"100%"},attrs:{"element-loading-text":e.$t("test_track.case.import.importing"),"element-loading-spinner":"el-icon-loading",multiple:"",drag:"",limit:1,action:"","on-exceed":e.handleExceed,beforeUpload:e.uploadValidate,"on-error":e.handleError,"show-file-list":!1,"http-request":e.upload,"file-list":e.fileList}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text",domProps:{innerHTML:e._s(e.$t("load_test.upload_tips"))}}),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.$t("api_test.api_import.file_size_limit")))])])],1),s("el-row",[s("ul",e._l(e.errList,(function(t){return s("li",{key:t.rowNum},[e._v(" "+e._s(t.errMsg)+" ")])})),0)])],1)},h=[],g=(s("10dd"),s("dca2")),b=s("ae75"),_=s("4abd"),v=(s("4ff3"),{name:"UserImport",components:{ElUploadList:g["a"],MsTableButton:b["a"]},data:function(){return{result:{},activeName:"excelImport",dialogVisible:!1,fileList:[],errList:[],isLoading:!1}},methods:{handleExceed:function(e,t){this.$warning(this.$t("test_track.case.import.upload_limit_count"))},uploadValidate:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1);return"xls"!=t&&"xlsx"!=t?(this.$warning(this.$t("test_track.case.import.upload_limit_format")),!1):e.size/1024/1024>20?(this.$warning(this.$t("test_track.case.import.upload_limit_size")),!1):(this.isLoading=!0,this.errList=[],!0)},handleError:function(e,t,s){this.isLoading=!1,this.$error(e.message)},open:function(){Object(d["v"])(this.close),this.projectId=Object(d["g"])(),this.dialogVisible=!0},close:function(){Object(d["z"])(this.close),this.dialogVisible=!1,this.fileList=[],this.errList=[]},downloadTemplate:function(){this.$fileDownload("/user/export/template")},upload:function(e){var t=this;this.isLoading=!1,this.fileList.push(e.file);JSON.parse(localStorage.getItem(_["M"]));this.result=this.$fileUpload("/user/import",e.file,null,{},(function(e){var s=e.data;s.success?(t.$success(t.$t("commons.import_success")),t.dialogVisible=!1,t.$emit("refreshAll")):t.errList=s.errList,t.fileList=[]}),(function(e){t.fileList=[]}))}}}),$=v,w=(s("0022"),s("cba8")),S=Object(w["a"])($,f,h,!1,null,"32a73e44",null),x=S.exports,y=s("665c"),k=s("e077"),E=s("6541"),R=s("eab7"),C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{staticClass:"edit-user-dialog",attrs:{"close-on-click-modal":!1,title:e.title,visible:e.createVisible,width:"40%","destroy-on-close":!0},on:{"update:visible":function(t){e.createVisible=t},closed:e.handleClose},scopedSlots:e._u([{key:"footer",fn:function(){return[s("div",{staticClass:"dialog-footer"},[s("el-button",{attrs:{size:"medium"},on:{click:function(t){e.createVisible=!1}}},[e._v(e._s(e.$t("commons.cancel")))]),s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.createUser("createUserForm")}},nativeOn:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.preventDefault()}}},[e._v(" "+e._s(e.$t("commons.confirm"))+" ")])],1)]},proxy:!0}])},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.result.loading,expression:"result.loading"}]},[s("el-form",{ref:"createUserForm",attrs:{model:e.form,"label-position":"right","label-width":"120px",size:"small",rules:e.rule}},[s("el-form-item",{attrs:{label:"ID",prop:"id"}},[s("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("user.input_id_placeholder"),disabled:"Edit"===e.type},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),s("el-form-item",{attrs:{label:e.$t("commons.username"),prop:"name"}},[s("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("user.input_name")},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),s("el-form-item",{attrs:{label:e.$t("commons.email"),prop:"email"}},[s("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("user.input_email")},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),s("el-form-item",{attrs:{label:e.$t("commons.phone"),prop:"phone"}},[s("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("user.input_phone")},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),"Add"===e.type?s("el-form-item",{attrs:{label:e.$t("commons.password"),prop:"password"}},[s("el-input",{attrs:{autocomplete:"new-password","show-password":"",placeholder:e.$t("user.input_password")},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1):e._e(),e._l(e.form.groups,(function(t,r){return s("div",{key:r},[s("el-form-item",{attrs:{label:"用户组"+r,prop:"groups."+r+".type",rules:{required:!0,message:"请选择用户组",trigger:"change"}}},[s("el-select",{staticClass:"edit-user-select",attrs:{filterable:"",placeholder:"请选择用户组",disabled:!!t.type},on:{change:function(s){return e.getResource(t.type,r)}},model:{value:t.type,callback:function(s){e.$set(t,"type",s)},expression:"group.type"}},e._l(e.activeGroup(t),(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id+"+"+e.type}})})),1),e.form.groups.length>1?s("el-button",{staticStyle:{"margin-left":"20px"},on:{click:function(s){return s.preventDefault(),e.removeGroup(t)}}},[e._v(" "+e._s(e.$t("commons.delete"))+" ")]):e._e()],1),e.groupType(t.type)===e.org?s("div",[s("el-form-item",{attrs:{label:e.$t("organization.select_organization"),prop:"groups."+r+".ids",rules:{required:!0,message:e.$t("organization.select_organization"),trigger:"change"}}},[s("el-select",{staticClass:"edit-user-select",attrs:{filterable:"",placeholder:e.$t("organization.select_organization"),multiple:""},model:{value:t.ids,callback:function(s){e.$set(t,"ids",s)},expression:"group.ids"}},e._l(t.organizations,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1):e._e(),e.groupType(t.type)===e.ws?s("div",[s("el-form-item",{attrs:{label:e.$t("workspace.select"),prop:"groups."+r+".ids",rules:{required:!0,message:e.$t("workspace.select"),trigger:"change"}}},[s("el-select",{staticClass:"edit-user-select",attrs:{filterable:"",placeholder:e.$t("workspace.select"),multiple:""},model:{value:t.ids,callback:function(s){e.$set(t,"ids",s)},expression:"group.ids"}},e._l(t.workspaces,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1):e._e(),e.groupType(t.type)===e.project?s("div",[s("el-form-item",{attrs:{label:"选择项目",prop:"groups."+r+".ids",rules:{required:!0,message:"请选择项目",trigger:"change"}}},[s("el-select",{staticClass:"edit-user-select",attrs:{filterable:"",placeholder:"请选择项目",multiple:""},model:{value:t.ids,callback:function(s){e.$set(t,"ids",s)},expression:"group.ids"}},e._l(t.projects,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1):e._e()],1)})),s("el-form-item",[[s("el-button",{staticStyle:{width:"100%"},attrs:{type:"success",disabled:e.btnAddRole},on:{click:function(t){return e.addGroup("createUserForm")}}},[e._v(" "+e._s(e.$t("group.add"))+" ")])]],2)],2)],1)])},P=[],D=(s("5a05"),s("993f"),s("fee8"),{name:"EditUser",components:{},data:function(){return{result:{},createVisible:!1,updateVisible:!1,btnAddRole:!1,form:{groups:[{type:""}]},rule:{id:[{required:!0,message:this.$t("user.input_id"),trigger:"blur"},{min:1,max:50,message:this.$t("commons.input_limit",[1,50]),trigger:"blur"},{required:!0,pattern:"^[^一-龥]+$",message:this.$t("user.special_characters_are_not_supported"),trigger:"blur"}],name:[{required:!0,message:this.$t("user.input_name"),trigger:"blur"},{min:2,max:50,message:this.$t("commons.input_limit",[2,50]),trigger:"blur"},{required:!0,message:this.$t("user.special_characters_are_not_supported"),trigger:"blur"}],phone:[{pattern:m["b"],message:this.$t("user.mobile_number_format_is_incorrect"),trigger:"blur"}],email:[{required:!0,message:this.$t("user.input_email"),trigger:"blur"},{required:!0,pattern:m["a"],message:this.$t("user.email_format_is_incorrect"),trigger:"blur"}],password:[{required:!0,message:this.$t("user.input_password"),trigger:"blur"},{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,30}$/,message:this.$t("member.password_format_is_incorrect"),trigger:"blur"}]},userGroup:[],organizations:[],workspaces:[],projects:[],type:"Add",title:"创建用户"}},computed:{org:function(){return _["i"]},ws:function(){return _["l"]},project:function(){return _["j"]}},methods:{open:function(e,t,s){var r=this;this.type=e||this.type,this.title=t||this.title,"Edit"===e&&(this.result=this.$get("/user/group/all/"+encodeURIComponent(s.id),(function(e){var t=e.data;r.$set(r.form,"groups",t)})),this.form=Object.assign({},s)),this.createVisible=!0,this.getAllUserGroup()},handleClose:function(){this.createVisible=!1,this.form={groups:[{type:""}]},this.btnAddRole=!1},activeGroup:function(e){return this.userGroup.filter((function(t){var s=!0;if(!e.selects)return!0;0===e.selects.length&&(s=!0);for(var r=0;r<e.selects.length;r++){var a=t.id+"+"+t.type;a===e.selects[r]&&(s=!1)}return s}))},removeGroup:function(e){var t=this.form.groups.indexOf(e);-1!==t&&this.form.groups.splice(t,1),this.form.groups.length<this.userGroup.length&&(this.btnAddRole=!1)},addGroup:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var s={selects:[]},r=t.form.groups.map((function(e){return e.type}));r.forEach((function(e){s.selects.push(e)}));var a=t.form.groups;a.push(s),t.form.groups.length>t.userGroup.length-1&&(t.btnAddRole=!0)}))},createUser:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var s="Add"===t.type?"/user/special/add":"/user/special/update";t.result=t.$post(s,t.form,(function(){t.$success(t.$t("commons.save_success")),t.$emit("refresh"),t.createVisible=!1}))}))},getAllUserGroup:function(){var e=this;this.$post("/user/group/get",{type:_["k"]},(function(t){var s=t.data;s&&(e.userGroup=s)}))},groupType:function(e){if(e)return e.split("+")[1]},getResource:function(e,t){var s=this;if(e){var r=e.split("+")[0],a=e.split("+")[1];this.result=this.$get("/organization/list/resource/"+r+"/"+a,(function(e){var r=e.data;r&&s._setResource(r,t,a)}))}},_setResource:function(e,t,s){switch(s){case _["i"]:this.form.groups[t].organizations=e.organizations;break;case _["l"]:this.form.groups[t].workspaces=e.workspaces;break;case _["j"]:this.form.groups[t].projects=e.projects;break;default:}}}}),A=D,j=(s("ccff"),Object(w["a"])(A,C,P,!1,null,"f570b0d4",null)),T=j.exports,O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"user-cascade",attrs:{title:e.title,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[s("div",{staticClass:"block"},[s("el-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{title:e.$t("user.add_project_batch_tip"),type:"info","show-icon":"",closable:!1}}),s("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[s("el-form-item",{attrs:{prop:"project","label-width":"0px"}},[s("el-cascader-panel",{key:e.isResourceShow,ref:"cascadeSelector",attrs:{props:e.props,"popper-class":"ms-cascade",clearable:""},model:{value:e.selectedIds,callback:function(t){e.selectedIds=t},expression:"selectedIds"}})],1)],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("ms-dialog-footer",{on:{cancel:function(t){return e.close()},confirm:function(t){return e.confirm()}}})],1)])},z=[],U=(s("d5ee"),{name:"User2ProjectCascader",components:{ElUploadList:g["a"],MsTableButton:b["a"],MsDialogFooter:c["a"]},data:function(){var e=this,t=function(t,s,r){var a=e.$refs.cascadeSelector.getCheckedNodes(!0);0===a.length&&r(new Error(e.$t("user.select_project").toString())),r()},s=this;return{ruleForm:{project:""},rules:{project:[{validator:t,message:this.$t("user.select_project"),trigger:"change"}]},selectedIds:[],isResourceShow:0,props:{multiple:!0,lazy:!0,value:"id",label:"name",lazyLoad:function(e,t){var r=e.level,a=e.value;0===r?s.getOrganization(t):1===r?s.getWorkspace(a,t):2===r?s.getProject(a,t):t([])}},dialogVisible:!1,loading:!1}},props:{title:{type:String,default:""}},methods:{close:function(){Object(d["z"])(this.close),this.loading=!1,this.dialogVisible=!1,this.selectedIds=[],++this.isResourceShow,this.$refs["ruleForm"].resetFields()},open:function(){Object(d["v"])(this.close),this.dialogVisible=!0,this.rules.project[0].message=this.$t("user.select_project")},confirm:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;for(var s=e.$refs.cascadeSelector.getCheckedNodes(!0),r=[],a=0;a<s.length;a++)r.push(s[a].value);e.$emit("confirm","ADD_PROJECT",r),e.loading=!0}))},getOrganization:function(e){this.$get("organization/list",(function(t){var s=t.data?t.data:[];s.length>0&&s.forEach((function(e){return e.leaf=!1})),e(s)}))},getWorkspace:function(e,t){this.$get("workspace/list/"+e,(function(e){var s=e.data?e.data:[];s.length>0&&s.forEach((function(e){return e.leaf=!1})),t(s)}))},getProject:function(e,t){this.$get("project/listAll/"+e,(function(e){var s=e.data?e.data:[];s.length>0&&s.forEach((function(e){return e.leaf=!0})),t(s)}))}}}),I=U,F=(s("e4aa"),Object(w["a"])(I,O,z,!1,null,"37119a90",null)),V=F.exports,L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"user-cascade",attrs:{title:e.title,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},close:e.close}},[s("div",{staticClass:"block"},[s("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[s("el-form-item",{attrs:{prop:"project","label-width":"0px"}},[s("el-cascader-panel",{key:e.isResourceShow,ref:"cascadeSelector",attrs:{props:e.props,"popper-class":"ms-cascade",emitPath:!0,clearable:""}})],1)],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("ms-dialog-footer",{on:{cancel:function(t){return e.close()},confirm:function(t){return e.confirm()}}})],1)])},M=[],q=s("ebb4"),G=s("e5a9"),N={name:"GroupCascader",components:{ElUploadList:g["a"],MsTableButton:b["a"],MsDialogFooter:c["a"]},data:function(){var e=this,t=function(t,s,r){var a=e.$refs.cascadeSelector.getCheckedNodes(!0);0===a.length&&r(new Error(e.$t("user.select_group").toString())),r()},s=this;return{ruleForm:{project:""},rules:{project:[{validator:t,message:this.$t("user.select_group"),trigger:"change"}]},selectedIds:[],isResourceShow:0,props:{multiple:!0,lazy:!0,value:"id",label:"showLabel",lazyLoad:function(e,t){var r=e.level;0===r?s.getGroup(t):1===r?s.getResource(e,t):t([])}},dialogVisible:!1,loading:!1}},props:{title:{type:String,default:""}},methods:{close:function(){Object(d["z"])(this.close),this.loading=!1,this.dialogVisible=!1,this.selectedIds=[],++this.isResourceShow,this.$refs["ruleForm"].resetFields()},open:function(){Object(d["v"])(this.close),this.dialogVisible=!0,this.rules.project[0].message=this.$t("user.select_group")},confirm:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var s,r=e.$refs.cascadeSelector.getCheckedNodes(!0),a=[],i=Object(q["a"])(r);try{for(i.s();!(s=i.n()).done;){var o=s.value,l="";l=o.parent?o.parent.value+"+"+o.value:o.value+"+none",a.push(l)}}catch(n){i.e(n)}finally{i.f()}e.$emit("confirm","ADD_USER_GROUP",a),e.loading=!0}))},getGroup:function(e){this.$get("user/group/get/all",(function(t){var s=t.data?t.data:[];s.length>0&&s.forEach((function(e){e.leaf=e.type===_["k"],e.showLabel="["+G["k"][e.type]+"] "+e.name})),e(s)}))},getResource:function(e,t){var s=e.data.type,r=e.value;this.$get("user/group/"+s+"/"+r,(function(e){var s=e.data?e.data:[];s.length>0&&s.forEach((function(e){e.leaf=!0,e.showLabel=e.name})),t(s)}))}}},B=N,Z=(s("218d"),Object(w["a"])(B,L,M,!1,null,"94924430",null)),J=Z.exports,W={name:"MsUser",components:{GroupCascader:J,EditUser:T,MsCreateBox:i["a"],MsTablePagination:o["a"],MsTableHeader:l["a"],MsTableOperator:n["a"],MsDialogFooter:c["a"],MsTableOperatorButton:u["a"],MsRolesTag:p["a"],UserImport:x,MsTableHeaderSelectPopover:y["a"],UserCascader:E["a"],ProjectCascader:V,ShowMoreBtn:R["a"]},inject:["reload"],data:function(){var e=this,t=function(t,s,r){""===s?r(new Error(e.$t("user.input_password"))):s!==e.ruleForm.newpassword?r(new Error(e.$t("member.inconsistent_passwords"))):r()};return{referenced:!1,queryPath:"/user/special/list",deletePath:"/user/special/delete/",createPath:"/user/special/add",updatePath:"/user/special/update",editPasswordPath:"/user/special/password",batchAddTitle:this.$t("user.add_project_batch"),result:{},currentUserId:"",createVisible:!1,updateVisible:!1,selectDataCounts:0,editPasswordVisible:!1,btnAddRole:!1,multipleSelection:[],userRole:[],currentPage:1,pageSize:10,total:0,condition:{},selectRows:new Set,tableData:[],form:{roles:[{id:""}]},screenHeight:"calc(100vh - 195px)",checkPasswordForm:{},ruleForm:{},buttons:[{name:this.$t("user.add_project_batch"),handleClick:this.addToProjectBatch},{name:this.$t("user.add_user_group_batch"),handleClick:this.addUserGroupBatch}],rule:{id:[{required:!0,message:this.$t("user.input_id"),trigger:"blur"},{min:1,max:50,message:this.$t("commons.input_limit",[1,50]),trigger:"blur"},{required:!0,pattern:"^[^一-龥]+$",message:this.$t("user.special_characters_are_not_supported"),trigger:"blur"}],name:[{required:!0,message:this.$t("user.input_name"),trigger:"blur"},{min:2,max:50,message:this.$t("commons.input_limit",[2,50]),trigger:"blur"},{required:!0,message:this.$t("user.special_characters_are_not_supported"),trigger:"blur"}],phone:[{pattern:m["b"],message:this.$t("user.mobile_number_format_is_incorrect"),trigger:"blur"}],email:[{required:!0,message:this.$t("user.input_email"),trigger:"blur"},{required:!0,pattern:/^[a-zA-Z0-9_._-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,message:this.$t("user.email_format_is_incorrect"),trigger:"blur"}],password:[{required:!0,message:this.$t("user.input_password"),trigger:"blur"},{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,30}$/,message:this.$t("member.password_format_is_incorrect"),trigger:"blur"}],newpassword:[{required:!0,message:this.$t("user.input_password"),trigger:"blur"},{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,30}$/,message:this.$t("member.password_format_is_incorrect"),trigger:"blur"}],confirmpassword:[{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,30}$/,message:this.$t("member.password_format_is_incorrect"),trigger:"blur"},{trigger:["blur","change"],validator:t}]},userGroup:[]}},activated:function(){this.currentUserId=Object(d["h"])().id,this.search()},methods:{create:function(){this.$refs.editUser.open("Add",this.$t("user.create"))},edit:function(e){this.$refs.editUser.open("Edit",this.$t("user.modify"),e)},editPassword:function(e){this.editPasswordVisible=!0,this.ruleForm=Object.assign({},e),Object(d["v"])(this.handleClose)},del:function(e){var t=this;this.$confirm(this.$t("user.delete_confirm"),"",{confirmButtonText:this.$t("commons.confirm"),cancelButtonText:this.$t("commons.cancel"),type:"warning"}).then((function(){t.result=t.$get(t.deletePath+encodeURIComponent(e.id),(function(){t.$success(t.$t("commons.delete_success")),t.search()}))})).catch((function(){t.$info(t.$t("commons.delete_cancel"))}))},createUser:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.result=t.$post(t.createPath,t.form,(function(){t.$success(t.$t("commons.save_success")),t.search(),t.createVisible=!1}))}))},updateUser:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.result=t.$post(t.updatePath,t.form,(function(){t.$success(t.$t("commons.modify_success")),t.updateVisible=!1,t.search()}))}))},editUserPassword:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.result=t.$post(t.editPasswordPath,t.ruleForm,(function(){t.$success(t.$t("commons.modify_success")),t.editPasswordVisible=!1,t.search(),t.reload()}))}))},search:function(){var e=this;this.selectRows=new Set,this.condition.selectAll=!1,this.result=this.$post(this.buildPagePath(this.queryPath),this.condition,(function(t){var s=t.data;e.total=s.itemCount,e.tableData=s.listObject;for(var r="/user/special/user/group",a=function(t){e.tableData[t].id&&e.$get(r+"/"+encodeURIComponent(e.tableData[t].id),(function(s){var r=s.data,a=r.groups;e.$set(e.tableData[t],"roles",a),e.$set(e.tableData[t],"isLocalUser","LOCAL"===e.tableData[t].source)}))},i=0;i<e.tableData.length;i++)a(i);e.$nextTick((function(){this.checkTableRowIsSelect()}))}))},checkTableRowIsSelect:function(){var e=this;if(this.condition.selectAll){var t=this.condition.unSelectIds;this.tableData.forEach((function(s){t.indexOf(s.id)<0?(e.$refs.userTable.toggleRowSelection(s,!0),e.selectRows.has(s)||(e.$set(s,"showMore",!0),e.selectRows.add(s))):e.selectRows.has(s)&&(e.$set(s,"showMore",!1),e.selectRows.delete(s))}))}},handleClose:function(){this.form={roles:[{id:""}]},this.btnAddRole=!1,Object(d["z"])(this.handleClose),this.editPasswordVisible=!1,this.createVisible=!1,this.updateVisible=!1},changeSwitch:function(e){var t=this;this.$post("/user/special/update_status",e,(function(){t.$success(t.$t("commons.modify_success"))}))},buildPagePath:function(e){return e+"/"+this.currentPage+"/"+this.pageSize},handleSelectionChange:function(e){this.multipleSelection=e},getOrgList:function(){var e=this;this.$get("/organization/list",(function(t){e.$set(e.form,"orgList",t.data)}))},getWsList:function(){var e=this;this.$get("/workspace/list",(function(t){e.$set(e.form,"wsList",t.data)}))},importUserDialogOpen:function(){this.$refs.userImportDialog.open()},handleSelectAll:function(e){Object(k["c"])(this,e,this.tableData,this.selectRows,this.condition),Object(k["A"])(this.tableData,this.condition,this.selectRows),this.selectDataCounts=Object(k["u"])(this.condition,this.total,this.selectRows),this.$emit("selection",e)},handleSelect:function(e,t){Object(k["b"])(this,e,t,this.selectRows),Object(k["A"])(this.tableData,this.condition,this.selectRows),this.selectDataCounts=Object(k["u"])(this.condition,this.total,this.selectRows),this.$emit("selection",e)},isSelectDataAll:function(e){this.condition.selectAll=e,Object(k["A"])(this.tableData,this.condition,this.selectRows),this.condition.unSelectIds=[],this.selectDataCounts=Object(k["u"])(this.condition,this.total,this.selectRows),Object(k["B"])(this.$refs.userTable,this.tableData,this.selectRows)},addToProjectBatch:function(){this.$refs.cascaderDialog.open()},addUserGroupBatch:function(){this.$refs.groupCascaderDialog.open()},cascaderConfirm:function(e,t){var s=this;0===t.length&&this.$success(this.$t("commons.modify_success"));var r={};r=this.buildBatchParam(r),r.batchType=e,r.batchProcessValue=t,this.$post("/user/special/batchProcessUserInfo",r,(function(){s.$success(s.$t("commons.modify_success")),s.search(),s.cascaderClose(e)}),(function(){s.cascaderRequestError(e)}))},cascaderRequestError:function(e){"ADD_PROJECT"===e?this.$refs.cascaderDialog.loading=!1:this.$refs.groupCascaderDialog.loading=!1},cascaderClose:function(e){"ADD_PROJECT"===e?this.$refs.cascaderDialog.close():this.$refs.groupCascaderDialog.close()},buildBatchParam:function(e){return e.ids=Array.from(this.selectRows).map((function(e){return e.id})),e.projectId=Object(d["g"])(),e.condition=this.condition,e}}},Y=W,H=(s("cb6b"),Object(w["a"])(Y,r,a,!1,null,"2c2997fb",null));t["default"]=H.exports},f4d0:function(e,t,s){}}]);