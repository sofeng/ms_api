(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d12bd3a4"],{"4e10":function(e,t,i){"use strict";i("d236")},"7e6d":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.result.loading,expression:"result.loading"}]},[i("el-card",{staticClass:"table-card",scopedSlots:e._u([{key:"header",fn:function(){return[i("div",{staticStyle:{"font-size":"16px","margin-bottom":"20px","margin-left":"10px"}},[e._v(" "+e._s(e.$t("operating_log.title"))+" ")]),i("div",[i("el-form",{ref:"basicForm",staticStyle:{"margin-right":"20px"},attrs:{model:e.condition,"label-position":"right","label-width":"75px",size:"small"}},[i("el-row",[i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{label:e.$t("operating_log.time"),prop:"times"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{size:"small",type:"datetimerange","value-format":"timestamp","range-separator":e.$t("commons.date.range_separator"),"start-placeholder":e.$t("schedule.cron.start"),"end-placeholder":e.$t("variables.end")},model:{value:e.condition.times,callback:function(t){e.$set(e.condition,"times",t)},expression:"condition.times"}})],1)],1),i("el-col",{attrs:{span:4}},[i("el-form-item",{attrs:{label:e.$t("operating_log.user"),prop:"user"}},[i("el-autocomplete",{staticClass:"input-with-autocomplete",attrs:{placeholder:e.$t("member.input_id_or_email"),"trigger-on-focus":!1,"fetch-suggestions":e.querySearch,size:"small","highlight-first-item":"","value-key":"email"},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"ws-member-name"},[e._v(e._s(t.item.name))]),i("span",{staticClass:"ws-member-email"},[e._v(e._s(t.item.email))])]}}]),model:{value:e.condition.operUser,callback:function(t){e.$set(e.condition,"operUser",t)},expression:"condition.operUser"}})],1)],1),i("el-col",{attrs:{span:4}},[i("el-form-item",{attrs:{label:e.$t("commons.project"),prop:"project"}},[i("el-select",{attrs:{size:"small",clearable:""},on:{change:e.initTableData},model:{value:e.condition.projectId,callback:function(t){e.$set(e.condition,"projectId",t)},expression:"condition.projectId"}},e._l(e.items,(function(t){return i("el-option",{key:t.id,attrs:{label:e.$t(t.label),value:t.id}})})),1)],1)],1),i("el-col",{attrs:{span:4}},[i("el-form-item",{attrs:{label:e.$t("operating_log.type"),prop:"type"}},[i("el-select",{attrs:{size:"small",clearable:""},on:{change:e.initTableData},model:{value:e.condition.operType,callback:function(t){e.$set(e.condition,"operType",t)},expression:"condition.operType"}},e._l(e.LOG_TYPE,(function(t){return i("el-option",{key:t.id,attrs:{label:e.$t(t.label),value:t.id}})})),1)],1)],1),i("el-col",{attrs:{span:4}},[i("el-form-item",{attrs:{label:e.$t("operating_log.object"),prop:"module"}},[i("el-cascader",{ref:"cascade",staticClass:"ms-case",attrs:{"show-all-levels":"",filterable:"",options:e.sysList,placeholder:e.$t("operating_log.object"),props:e.props},on:{change:e.initTableData},model:{value:e.condition.operModules,callback:function(t){e.$set(e.condition,"operModules",t)},expression:"condition.operModules"}})],1)],1),i("el-col",{attrs:{span:3}},[i("div",{staticStyle:{width:"140px"}},[i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:e.search}},[e._v(" "+e._s(e.$t("commons.adv_search.search"))+" ")]),i("el-button",{attrs:{size:"small"},on:{click:e.reset}},[e._v(" "+e._s(e.$t("commons.adv_search.reset"))+" ")])],1)])],1)],1)],1)]},proxy:!0}])},[i("el-table",{ref:"operLog",staticClass:"adjust-table",attrs:{border:"",data:e.tableData,height:e.screenHeight}},[i("el-table-column",{attrs:{prop:"operTime",label:e.$t("operating_log.time")},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("timestampFormatDate")(t.row.operTime)))])]}}])}),i("el-table-column",{attrs:{prop:"userName",label:e.$t("operating_log.user")}}),i("el-table-column",{attrs:{prop:"projectName",label:e.$t("commons.project")}}),i("el-table-column",{attrs:{prop:"operType",label:e.$t("operating_log.type")},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.getType(t.row.operType)))])]}}])}),i("el-table-column",{attrs:{prop:"operModule",label:e.$t("operating_log.object"),"show-overflow-tooltip":"",width:"120px"}}),i("el-table-column",{attrs:{prop:"operTitle",label:e.$t("operating_log.name"),"show-overflow-tooltip":"",width:"150px"}}),i("el-table-column",{attrs:{label:e.$t("report.test_log_details")},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-link",{staticStyle:{color:"#409EFF"},on:{click:function(i){return e.openDetail(t.row)}}},[e._v(e._s(e.$t("operating_log.info")))])]}}])})],1),i("ms-table-pagination",{attrs:{change:e.initTableData,"current-page":e.currentPage,"page-size":e.pageSize,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1),i("ms-log-detail",{ref:"logDetail",attrs:{title:e.$t("report.test_log_details")}})],1)},l=[],s=(i("bb13"),i("89a8"),i("b110"),i("fe35"),i("10dd"),i("5a05"),i("1a91"),i("59d9")),o=i("1c98"),n=i("495f"),r=(i("4abd"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{"close-on-click-modal":!1,title:e.getType(e.detail.operType)+e.title,visible:e.infoVisible,width:"65%","destroy-on-close":!0},on:{"update:visible":function(t){e.infoVisible=t},close:e.handleClose}},[e.detail.createUser?i("div",[i("p",{staticClass:"tip"},[e._v(e._s(this.$t("report.user_name"))+" ："+e._s(e.detail.createUser))])]):e._e(),i("div",[i("p",{staticClass:"tip"},[e._v(e._s(this.$t("operating_log.user"))+" ："+e._s(e.detail.operUser))])]),i("div",[i("p",{staticClass:"tip"},[e._v(e._s(this.$t("operating_log.time"))+" ："+e._s(e._f("timestampFormatDate")(e.detail.operTime)))])]),i("div",[i("p",{staticClass:"tip"},[e._v(e._s(this.$t("report.test_log_details"))+" ")]),e.detail&&"CREATE"!==e.detail.operType&&"DELETE"!==e.detail.operType&&"COPY"!==e.detail.operType&&e.detail&&e.detail.details&&e.detail.details.columns&&e.detail.details.columns.length>0?i("div",[e.detail&&e.detail.details&&e.detail.details.columns?i("div",{staticStyle:{"margin-left":"20px"}},[i("el-table",{attrs:{data:e.detail.details.columns}},[i("el-table-column",{attrs:{prop:"columnTitle",label:e.$t("operating_log.change_field"),width:"150px","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"newValue",label:e.$t("operating_log.change_content")},scopedSlots:e._u([{key:"default",fn:function(t){return[-1!==e.timeDates.indexOf(t.row.columnName)?i("span",[e._v(e._s(e._f("timestampFormatDate")(t.row.newValue)))]):i("div",{domProps:{innerHTML:e._s(e.getDiff(t.row.originalValue,t.row.newValue))}})]}}],null,!1,3309017964)})],1)],1):e._e()]):e.detail&&("DELETE"===e.detail.operType||null===e.detail.details||e.detail.details&&e.detail.details.columns&&0===e.detail.details.columns.length)?i("div",[i("div",[e._v(e._s(e.detail.operTitle))]),i("span",{staticStyle:{color:"#409EFF"}},[e._v(e._s(e.getType(e.detail.operType))+" ")]),i("span",{staticStyle:{color:"#409EFF"}},[e._v(" "+e._s(e.$t("api_test.home_page.detail_card.success")))])]):i("div",[e.detail&&e.detail.details&&e.detail.details.columns?i("div",{staticStyle:{overflow:"auto"}},e._l(e.detail.details.columns,(function(t){return i("span",{key:t.id},[-1!==e.timeDates.indexOf(t.columnName)?i("div",[e._v(" "+e._s(t.columnTitle)+"："+e._s(e._f("timestampFormatDate")(t.originalValue))+" ")]):e.isJson(t.originalValue)?i("div",[e._v(" "+e._s(t.columnTitle)+"："),i("pre",[e._v(e._s(t.originalValue))])]):i("div",{staticStyle:{"margin-top":"10px"}},[e._v(" "+e._s(t.columnTitle)+"："+e._s(t.originalValue)+" ")])])})),0):e._e()])])])}),c=[],d=(i("87bf"),i("cea3"),i("4c1e"),i("6370"),i("d5ee"),i("bbe2"),i("9525")),p=d.formatters.html,u={name:"MsLogDetail",components:{},props:{title:String},data:function(){return{infoVisible:!1,d1:"",d2:"",detail:{},LOG_TYPE:[{id:"CREATE",label:this.$t("api_test.definition.request.create_info")},{id:"DELETE",label:this.$t("commons.delete")},{id:"UPDATE",label:this.$t("commons.update")},{id:"IMPORT",label:this.$t("api_test.api_import.label")},{id:"EXPORT",label:this.$t("commons.export")},{id:"ASSOCIATE_CASE",label:this.$t("test_track.review_view.relevance_case")},{id:"ASSOCIATE_ISSUE",label:this.$t("test_track.case.relate_issue")},{id:"REVIEW",label:this.$t("test_track.review_view.start_review")},{id:"COPY",label:this.$t("commons.copy")},{id:"EXECUTE",label:this.$t("api_test.automation.execute")},{id:"CREATE_PRE_TEST",label:this.$t("api_test.create_performance_test")},{id:"SHARE",label:this.$t("operating_log.share")},{id:"LOGIN",label:this.$t("commons.login")},{id:"RESTORE",label:this.$t("commons.reduction")},{id:"DEBUG",label:this.$t("api_test.request.debug")},{id:"GC",label:this.$t("api_test.automation.trash")},{id:"BATCH_DEL",label:this.$t("api_test.definition.request.batch_delete")},{id:"BATCH_UPDATE",label:this.$t("api_test.definition.request.batch_edit")},{id:"BATCH_ADD",label:this.$t("commons.batch_add")},{id:"UN_ASSOCIATE_CASE",label:this.$t("test_track.case.unlink")},{id:"BATCH_RESTORE",label:"批量恢复"},{id:"BATCH_GC",label:"批量回收"}],LOG_TYPE_MAP:new Map([["CREATE",this.$t("api_test.definition.request.create_info")],["DELETE",this.$t("commons.delete")],["UPDATE",this.$t("commons.update")],["IMPORT",this.$t("api_test.api_import.label")],["EXPORT",this.$t("commons.export")],["ASSOCIATE_CASE",this.$t("test_track.review_view.relevance_case")],["ASSOCIATE_ISSUE",this.$t("test_track.case.relate_issue")],["REVIEW",this.$t("test_track.review_view.start_review")],["COPY",this.$t("commons.copy")],["EXECUTE",this.$t("api_test.automation.execute")],["CREATE_PRE_TEST",this.$t("api_test.create_performance_test")],["SHARE",this.$t("operating_log.share")],["LOGIN",this.$t("commons.login")],["RESTORE",this.$t("commons.reduction")],["DEBUG",this.$t("api_test.request.debug")],["GC",this.$t("api_test.automation.trash")],["BATCH_DEL",this.$t("api_test.definition.request.batch_delete")],["BATCH_UPDATE",this.$t("api_test.definition.request.batch_edit")],["BATCH_ADD",this.$t("commons.batch_add")],["BATCH_RESTORE","批量恢复"],["BATCH_GC","批量回收"],["UN_ASSOCIATE_CASE",this.$t("test_track.case.unlink")]]),timeDates:["plannedStartTime","plannedEndTime","startTime","endTime"]}},methods:{isJson:function(e){try{var t=new RegExp("^[0-9]*$");return!(!e||"null"===e||t.test(e))&&(JSON.parse(e),!0)}catch(i){return!1}},handleClose:function(){this.infoVisible=!1},getDiff:function(e,t){var i=d.diff(e,t);return p.format(i,e)},getDetails:function(e){var t=this;this.result=this.$get("/operating/log/get/"+e,(function(e){var i=e.data;t.detail=i}))},open:function(e){this.infoVisible=!0,this.getDetails(e)},getType:function(e){return this.LOG_TYPE_MAP.get(e)}}},_=u,m=(i("4e10"),i("cba8")),h=Object(m["a"])(_,r,c,!1,null,"d6bd652e",null),b=h.exports,f={name:"OperatingLog",components:{MsTablePagination:s["a"],MsTableOperator:o["a"],MsLogDetail:b},data:function(){return{props:{multiple:!1},result:{},form:{},currentPage:0,pageSize:10,total:0,items:[],condition:{},tableData:[],userList:[],screenHeight:"calc(100vh - 215px)",LOG_TYPE:[{id:"CREATE",label:this.$t("api_test.definition.request.create_info")},{id:"DELETE",label:this.$t("commons.delete")},{id:"UPDATE",label:this.$t("commons.update")},{id:"IMPORT",label:this.$t("api_test.api_import.label")},{id:"EXPORT",label:this.$t("commons.export")},{id:"ASSOCIATE_CASE",label:this.$t("test_track.review_view.relevance_case")},{id:"ASSOCIATE_ISSUE",label:this.$t("test_track.case.relate_issue")},{id:"UN_ASSOCIATE_CASE",label:this.$t("test_track.case.unlink")},{id:"REVIEW",label:this.$t("test_track.review_view.start_review")},{id:"COPY",label:this.$t("commons.copy")},{id:"EXECUTE",label:this.$t("api_test.automation.execute")},{id:"CREATE_PRE_TEST",label:this.$t("api_test.create_performance_test")},{id:"SHARE",label:this.$t("operating_log.share")},{id:"LOGIN",label:this.$t("commons.login")},{id:"RESTORE",label:this.$t("commons.reduction")},{id:"DEBUG",label:this.$t("api_test.request.debug")},{id:"GC",label:this.$t("api_test.automation.trash")},{id:"BATCH_DEL",label:this.$t("api_test.definition.request.batch_delete")},{id:"BATCH_UPDATE",label:this.$t("api_test.definition.request.batch_edit")},{id:"BATCH_ADD",label:this.$t("commons.batch_add")},{id:"BATCH_RESTORE",label:"批量恢复"},{id:"BATCH_GC",label:"批量回收"}],LOG_TYPE_MAP:new Map([["CREATE",this.$t("api_test.definition.request.create_info")],["DELETE",this.$t("commons.delete")],["UPDATE",this.$t("commons.update")],["IMPORT",this.$t("api_test.api_import.label")],["EXPORT",this.$t("commons.export")],["ASSOCIATE_CASE",this.$t("test_track.review_view.relevance_case")],["ASSOCIATE_ISSUE",this.$t("test_track.case.relate_issue")],["UN_ASSOCIATE_CASE",this.$t("test_track.case.unlink")],["REVIEW",this.$t("test_track.review_view.start_review")],["COPY",this.$t("commons.copy")],["EXECUTE",this.$t("api_test.automation.execute")],["CREATE_PRE_TEST",this.$t("api_test.create_performance_test")],["SHARE",this.$t("operating_log.share")],["LOGIN",this.$t("commons.login")],["RESTORE",this.$t("commons.reduction")],["DEBUG",this.$t("api_test.request.debug")],["GC",this.$t("api_test.automation.trash")],["BATCH_DEL",this.$t("api_test.definition.request.batch_delete")],["BATCH_UPDATE",this.$t("api_test.definition.request.batch_edit")],["BATCH_ADD",this.$t("commons.batch_add")],["BATCH_RESTORE","批量恢复"],["BATCH_GC","批量回收"]]),sysList:[{label:"测试跟踪",value:"测试跟踪",children:[{label:"测试用例",value:"测试用例",leaf:!0},{label:"用例评审",value:"用例评审",leaf:!0},{label:"测试计划",value:"测试计划",leaf:!0},{label:"缺陷管理",value:"缺陷管理",leaf:!0},{label:"报告",value:"报告",leaf:!0}]},{label:"接口测试",value:"api",children:[{label:"接口定义",value:"接口定义",leaf:!0},{label:"接口自动化",value:"接口自动化",leaf:!0},{label:"测试报告",value:"测试报告",leaf:!0}]},{label:"性能测试",value:"性能测试",children:[{label:"性能测试",value:"性能测试",leaf:!0},{label:"性能测试报告",value:"性能测试报告",leaf:!0}]},{label:"系统设置",value:"系统设置",children:[{label:"系统-用户",value:"系统-用户",leaf:!0},{label:"系统-组织",value:"系统-组织",leaf:!0},{label:"工作空间",value:"工作空间",leaf:!0},{label:"系统-测试资源池",value:"系统-测试资源池",leaf:!0},{label:"系统-系统参数设置",value:"系统-系统参数设置",leaf:!0},{label:"系统-配额管理",value:"系统-配额管理",leaf:!0},{label:"系统-授权管理",value:"系统-授权管理",leaf:!0},{label:"组织-成员",value:"组织-成员",leaf:!0},{label:"组织-服务集成",value:"组织-服务集成",leaf:!0},{label:"组织-消息设置",value:"组织-消息设置",leaf:!0},{label:"工作空间-成员",value:"工作空间-成员",leaf:!0},{label:"项目-项目管理",value:"项目-项目管理",leaf:!0},{label:"工作空间-模版设置",value:"工作空间-模版设置",leaf:!0},{label:"工作空间-项目管理",value:"工作空间-项目管理",leaf:!0},{label:"项目-项目管理",value:"项目-项目管理",leaf:!0},{label:"项目-成员",value:"项目-成员",leaf:!0},{label:"工作空间-成员",value:"工作空间-成员",leaf:!0},{label:"項目-JAR包管理",value:"項目-JAR包管理",leaf:!0},{label:"项目-环境设置",value:"项目-环境设置",leaf:!0},{label:"项目-文件管理",value:"项目-文件管理",leaf:!0},{label:"个人信息-个人设置",value:"个人信息-个人设置",leaf:!0},{label:"个人信息-API Keys",value:"个人信息-API Keys",leaf:!0}]}]}},mounted:function(){switch(this.$route.name){case"system":this.initProject("/project/listAll"),this.getMember();break;case"organization":this.initProject("/project/listAll/"+Object(n["j"])()),this.getMember();break;case"workspace":this.initProject("/project/listAll/"+Object(n["j"])()),this.getMember();break;case"project":this.getProject(),this.getMember();break}},watch:{$route:function(e,t){switch(e.name){case"system":this.initProject("/project/listAll"),this.getMember();break;case"organization":this.initProject("/project/listAll/"+Object(n["j"])()),this.getMember();break;case"workspace":this.initProject("/project/listAll/"+Object(n["j"])()),this.getMember();break;case"project":this.getProject(),this.getMember();break}}},methods:{handleSelect:function(e){this.$set(this.condition,"operUser",e.id)},getMember:function(){var e=this;this.result=this.$get("/user/list/",(function(t){e.userList=t.data}))},createFilter:function(e){return function(t){return 0===t.email.indexOf(e.toLowerCase())||0===t.id.indexOf(e.toLowerCase())}},querySearch:function(e,t){var i=this.userList,a=e?i.filter(this.createFilter(e)):i;t(a)},initTableData:function(){var e=this;this.condition.operModules&&this.condition.operModules.length>0&&(this.condition.operModule=this.condition.operModules[1]);var t="/operating/log/list/"+this.currentPage+"/"+this.pageSize;this.result.loading=!0,this.$post(t,this.condition,(function(t){e.tableData=t.data.listObject,e.total=t.data.itemCount,e.result.loading=!1}))},reset:function(){var e=this.condition.projectIds;this.condition={projectIds:e},this.initTableData()},initProject:function(e){var t=this;this.condition={},this.result=this.$get(e,(function(e){var i=e.data,a=[];i&&(t.items=[],i.forEach((function(e){var i={id:e.id,label:e.name};t.items.push(i),a.push(e.id)}))),t.condition.projectIds=a,t.initTableData()}))},getProject:function(){var e=this;this.condition.projectIds=[],this.result=this.$get("/project/get/"+Object(n["g"])(),(function(t){var i=t.data;e.items=[{id:i.id,label:i.name}],e.condition.projectIds=[i.id],e.condition.projectId=i.id,e.initTableData()}))},getType:function(e){return this.LOG_TYPE_MAP.get(e)},search:function(){this.initTableData()},openDetail:function(e){this.$refs.logDetail.open(e.id)}}},g=f,E=Object(m["a"])(g,a,l,!1,null,"1469050c",null);t["default"]=E.exports},d236:function(e,t,i){}}]);