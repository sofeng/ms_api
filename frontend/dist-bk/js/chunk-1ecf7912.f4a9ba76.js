(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ecf7912"],{"0ccc":function(e,t,i){"use strict";i("63dc")},1763:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",e._l(e.buttons,(function(t,n){return i("ms-table-operator-button",{directives:[{name:"permission",rawName:"v-permission",value:t.permissions,expression:"btn.permissions"}],key:n,class:t.class,attrs:{disabled:e.isDisable(t),tip:t.tip,icon:t.icon,type:t.type,isDivButton:t.isDivButton},on:{exec:function(i){return e.click(t)},click:function(i){return i.stopPropagation(),e.clickStop(t)}}})})),1)},s=[],a=(i("51b3"),i("4c1e"),i("be8e")),o={name:"MsTableOperators",components:{MsTableOperatorButton:a["a"]},props:{row:Object,buttons:Array,index:Number},methods:{click:function(e){e.exec instanceof Function&&e.exec(this.row,this.index)},clickStop:function(e){e.stop instanceof Function&&e.stop(this.row,this.index)},isDisable:function(e){return!!e.isDisable&&e.isDisable(this.row)}},computed:{isTesterPermission:function(){return function(e){return!1!==e.isTesterPermission}}}},r=o,l=i("cba8"),c=Object(l["a"])(r,n,s,!1,null,"54f0f89e",null);t["a"]=c.exports},"3cf1":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ms-container",[i("ms-main-container",[i("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.result.loading,expression:"result.loading"}],staticClass:"table-card",scopedSlots:e._u([{key:"header",fn:function(){return[i("ms-table-header",{attrs:{condition:e.condition,title:e.$t("commons.test"),createTip:e.$t("load_test.create"),runTip:e.$t("load_test.run"),"show-run":!0},on:{"update:condition":function(t){e.condition=t},search:e.search,create:e.create,runTest:e.runTest,historicalDataUpgrade:e.historicalDataUpgrade}})]},proxy:!0}])},[i("one-click-operation",{ref:"OneClickOperation",attrs:{"select-ids":e.selectIds,"select-project-names":e.selectProjectNames,"select-project-id":e.selectProjectId},on:{refresh:function(t){return e.init()}}}),i("el-table",{staticClass:"adjust-table table-content",attrs:{border:"",data:e.tableData},on:{"sort-change":e.sort,"row-click":e.handleView,"filter-change":e.filter,"select-all":e.select,select:e.select}},[i("el-table-column",{attrs:{type:"selection"}}),i("el-table-column",{attrs:{prop:"name",label:e.$t("commons.name"),width:"250","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"projectName",label:e.$t("load_test.project_name"),width:"200","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"userName",label:e.$t("api_test.creator"),width:"150","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{width:"250",label:e.$t("commons.create_time"),sortable:"",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("timestampFormatDate")(t.row.createTime)))])]}}])}),i("el-table-column",{attrs:{width:"250",label:e.$t("commons.update_time"),sortable:"",prop:"updateTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("timestampFormatDate")(t.row.updateTime)))])]}}])}),i("el-table-column",{attrs:{prop:"status",label:e.$t("commons.status"),"column-key":"status",filters:e.statusFilters},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[i("ms-api-test-status",{attrs:{row:t}})]}}])}),i("el-table-column",{attrs:{width:"150",label:e.$t("commons.operating")},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[i("ms-table-operators",{attrs:{buttons:e.buttons,row:t.row}})],1)]}}])})],1),i("ms-table-pagination",{attrs:{change:e.search,"current-page":e.currentPage,"page-size":e.pageSize,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1),i("api-copy-dialog",{ref:"apiCopy",on:{refresh:e.search}}),i("ms-upgrade",{ref:"upgrade",attrs:{"select-ids":e.selectIds,"select-project-names":e.selectProjectNames,"select-project-id":e.selectProjectId}})],1)],1)},s=[],a=(i("89a8"),i("d25d"),i("b110"),i("fe35"),i("1a91"),i("10dd"),i("4c1e"),i("6df5"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.$t("load_test.run"),visible:e.oneClickOperationVisible,width:"30%",left:"","destroy-on-close":!0,"show-close":""},on:{"update:visible":function(t){e.oneClickOperationVisible=t},closed:e.handleClose}},[i("el-form",{attrs:{model:e.ruleForm,"label-position":"right","label-width":"100px",size:"small",rules:e.rule}},[i("el-form-item",{attrs:{label:e.$t("test_track.case.test_name"),prop:"testName"}},[i("el-input",{attrs:{autocomplete:"off",clearable:"","show-word-limit":""},model:{value:e.ruleForm.testName,callback:function(t){e.$set(e.ruleForm,"testName",t)},expression:"ruleForm.testName"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("ms-dialog-footer",{on:{cancel:function(t){e.oneClickOperationVisible=!1},confirm:e.checkedSaveAndRunTest}})],1)],1)}),o=[],r=i("ebb4"),l=(i("bb13"),i("bbe2"),i("b3d9"),i("87d5"),i("e766"),i("15bc")),c=i("4dd5"),d=i("8aff"),u=i("c7ab"),p=i("f58a"),m=i("495f"),f=i("4f86"),h={name:"OneClickOperation",components:{MsApiReportDialog:p["a"],MsApiReportStatus:u["a"],MsApiScenarioConfig:d["a"],MsDialogFooter:l["a"]},data:function(){return{oneClickOperationVisible:!1,test:null,tests:[],ruleForm:{},change:!1,projectId:"",rule:{testName:[{required:!0,message:this.$t("api_test.input_name"),trigger:"blur"}]}}},watch:{test:{handler:function(){this.change=!0},deep:!0}},props:{selectIds:{type:Set},selectProjectNames:{type:Set},selectProjectId:{type:Set}},methods:{openOneClickOperation:function(){this.oneClickOperationVisible=!0},checkedSaveAndRunTest:function(){this.ruleForm.testName?this.selectProjectNames.size>1?(this.$warning(this.$t("load_test.same_project_test")),this.oneClickOperationVisible=!1,this.$emit("refresh")):this.checkNameResult(this.ruleForm.testName):this.$warning(this.$t("api_test.input_name"))},checkNameResult:function(){var e=this;this.checkName((function(){var t,i=Object(r["a"])(e.selectIds);try{for(i.s();!(t=i.n()).done;){var n=t.value;e.getTest(n)}}catch(s){i.e(s)}finally{i.f()}}))},checkName:function(e){var t,i=Object(r["a"])(this.selectProjectId);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.result=this.$post("/api/checkName",{name:this.ruleForm.testName,projectId:n},(function(){e&&e()}))}}catch(s){i.e(s)}finally{i.f()}},_getEnvironmentAndRunTest:function(e){var t=this;this.result=this.$get("/api/environment/list/"+e.projectId,(function(e){var i=e.data,n=new Map;i.forEach((function(e){Object(f["e"])(e),n.set(e.id,e)})),t.test.scenarioDefinition.forEach((function(e){if(e.environmentId){var t=n.get(e.environmentId);t?e.environment=t:e.environmentId=void 0}})),t.tests=[],t.saveRunTest(),t.oneClickOperationVisible=!1,t.$emit("refresh")}))},getTest:function(e){var t=this;this.result=this.$get("/api/get/"+e,(function(e){if(e.data){var i=e.data;t.tests.push(i);var n=new c["F"]({projectId:i.projectId,name:t.ruleForm.testName,scenarioDefinition:JSON.parse(i.scenarioDefinition),schedule:{}});t.test=t.test||n,t.tests.length>1&&(t.test.scenarioDefinition=t.test.scenarioDefinition.concat(n.scenarioDefinition)),t.tests.length===t.selectIds.size&&t._getEnvironmentAndRunTest(i)}}))},saveRunTest:function(){var e=this;this.change=!1,this.save((function(){e.$success(e.$t("commons.save_success")),e.runTest()}))},save:function(e){this.change=!1;var t="/api/create/merge";this.result=this.$request(this.getOptions(t,this.selectIds),(function(){e&&e()}))},runTest:function(){var e=this;this.result=this.$post("/api/run",{id:this.test.id,triggerMode:"MANUAL"},(function(t){e.$success(e.$t("api_test.running")),e.$router.push({path:"/api/report/view/"+t.data}),e.test=""}))},getOptions:function(e,t){var i=new FormData;i.append("request",new Blob([JSON.stringify(this.test)],{type:"application/json"})),i.append("selectIds",new Blob([JSON.stringify(Array.from(t))],{type:"application/json"}));var n=this.test.toJMX(),s=new Blob([n.xml],{type:"application/octet-stream"});return i.append("file",new File([s],n.name)),{method:"POST",url:e,data:i,headers:{"Content-Type":void 0}}},handleClose:function(){this.ruleForm={}}}},v=h,g=i("cba8"),b=Object(g["a"])(v,a,o,!1,null,"fc5ab012",null),$=b.exports,_=i("59d9"),y=i("10b9"),w=i("1c98"),k=i("1b11"),N=i("489a"),x=i("74cc"),j=i("1763"),C=i("8852"),O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.$t("api_test.copy"),visible:e.dialogFormVisible,"before-close":e.close,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[i("ms-dialog-footer",{on:{cancel:e.close,confirm:e.saveTest}})]},proxy:!0}])},[i("el-row",{attrs:{type:"flex",justify:"center"}},[i("el-col",{attrs:{span:18}},[i("el-form",{ref:"testForm",attrs:{model:e.form,rules:e.rules},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:e.$t("schedule.test_name"),"label-width":e.formLabelWidth,prop:"name"}},[i("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1)],1)],1)},I=[],T={components:{MsDialogFooter:l["a"]},data:function(){return{name:"MsApiCopyDialog",form:{name:""},rules:{name:[{required:!0,message:this.$t("test_track.case.input_name"),trigger:"blur"},{max:60,message:this.$t("test_track.length_less_than")+"60",trigger:"blur"}]},formLabelWidth:"80px",dialogFormVisible:!1,test:{}}},props:{treeNodes:{type:Array},currentProject:{type:Object}},methods:{open:function(e){Object(m["v"])(this.close),this.test=e,this.dialogFormVisible=!0},saveTest:function(){var e=this;this.$refs["testForm"].validate((function(t){if(!t)return!1;e.$post("/api/copy",{projectId:e.test.projectId,id:e.test.id,name:e.form.name},(function(){e.$success(e.$t("commons.copy_success")),e.dialogFormVisible=!1,e.$emit("refresh")}))}))},close:function(){this.form.name="",Object(m["z"])(this.close),this.dialogFormVisible=!1}}},S=T,P=Object(g["a"])(S,O,I,!1,null,"472bde98",null),M=P.exports,D=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:e.$t("commons.module.select_module"),visible:e.oneClickOperationVisible,width:"600px",left:"","destroy-on-close":!0,"show-close":""},on:{"update:visible":function(t){e.oneClickOperationVisible=t},closed:e.handleClose}},[i("ms-node-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.result.loading,expression:"result.loading"}],ref:"nodeTree",attrs:{"tree-nodes":e.data,type:"edit"},on:{add:e.add,edit:e.edit,drag:e.drag,remove:e.remove,nodeSelectEvent:e.nodeChange},scopedSlots:e._u([{key:"header",fn:function(){return[i("el-input",{attrs:{placeholder:e.$t("test_track.module.search"),size:"small"},model:{value:e.condition.filterText,callback:function(t){e.$set(e.condition,"filterText",t)},expression:"condition.filterText"}})]},proxy:!0}])}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("ms-dialog-footer",{on:{cancel:function(t){e.oneClickOperationVisible=!1},confirm:e.confirm}})],1)],1)},E=[],F=(i("5a05"),i("f968")),A=i("641e"),z=i("51fa"),V={name:"MsUpgrade",components:{MsApiReportDialog:p["a"],MsApiReportStatus:u["a"],MsApiScenarioConfig:d["a"],MsDialogFooter:l["a"],MsNodeTree:A["a"],SelectMenu:F["a"]},data:function(){return{oneClickOperationVisible:!1,moduleOptions:[],loading:!1,result:{},data:[],condition:{filterText:"",trashEnable:!1},currentModule:void 0}},props:{selectIds:{type:Set},selectProjectNames:{type:Set},selectProjectId:{type:Set}},watch:{"condition.filterText":function(e){this.$refs.nodeTree.filter(e)}},methods:{openOneClickOperation:function(){this.initModule(),this.oneClickOperationVisible=!0},getPath:function(e){var t=this.moduleOptions.filter((function(t){return t.id===e?t.path:""}));return t[0].path},confirm:function(){var e=this;if(this.currentModule)if("root"!==this.currentModule.id){this.loading=!0;var t=Array.from(this.selectIds),i={testIds:t,projectId:Object(m["g"])(),modulePath:this.getPath(this.currentModule.id),moduleId:this.currentModule.id};this.$post("/api/historicalDataUpgrade",i,(function(t){e.loading=!1,e.$success(e.$t("organization.integration.successful_operation")),e.oneClickOperationVisible=!1}))}else this.$warning("不能选默认模块，请重新选择一个模块");else this.$warning("请选择一个模块")},initModule:function(){var e=this,t="/api/automation/module/list/"+Object(m["g"])();this.$get(t,(function(t){if(void 0!=t.data&&null!=t.data){e.data=t.data;var i=[];e.data.forEach((function(e){Object(z["a"])(e,{path:""},i)})),e.moduleOptions=i}}))},handleClose:function(){this.ruleForm={}},edit:function(e){var t=this;e.projectId=Object(m["g"])(),e.protocol=this.condition.protocol,this.$post("/api/automation/module/edit",e,(function(){t.$success(t.$t("commons.save_success")),t.initModule(),t.refresh()}),(function(e){t.initModule()}))},add:function(e){var t=this;e.projectId=Object(m["g"])(),e.protocol=this.condition.protocol,this.$post("/api/automation/module/add",e,(function(){t.$success(t.$t("commons.save_success")),t.initModule()}),(function(e){t.initModule()}))},remove:function(e){var t=this;this.$post("/api/automation/module/delete",e,(function(){t.initModule(),t.refresh()}),(function(e){t.initModule()}))},drag:function(e,t){var i=this;this.$post("/api/automation/module/drag",e,(function(){i.$post("/api/automation/module/pos",t,(function(){i.initModule()}))}),(function(e){i.initModule()}))},nodeChange:function(e,t,i){this.currentModule=e.data,this.condition.trashEnable=!1,"root"===e.data.id?this.$emit("nodeSelectEvent",e,[],i):this.$emit("nodeSelectEvent",e,t,i)},saveAsEdit:function(e){this.$emit("saveAsEdit",e)},refresh:function(){this.$emit("refreshTable")},addScenario:function(){Object(m["g"])()?this.$refs.basisScenario.open(this.currentModule):this.$warning(this.$t("commons.check_project_tip"))},enableTrash:function(){this.condition.trashEnable=!0}}},R=V,B=Object(g["a"])(R,D,E,!1,null,"d9dd58b8",null),L=B.exports,U=i("e077"),J={components:{ApiCopyDialog:M,OneClickOperation:$,MsTableOperators:j["a"],MsApiTestStatus:x["a"],MsMainContainer:N["a"],MsContainer:k["a"],MsTableHeader:y["a"],MsTablePagination:_["a"],MsTableOperator:w["a"],MsUpgrade:L},data:function(){return{result:{},condition:{components:C["h"]},projectId:null,tableData:[],multipleSelection:[],currentPage:1,pageSize:10,total:0,loading:!1,selectIds:new Set,selectProjectNames:new Set,selectProjectId:new Set,buttons:[{tip:this.$t("commons.edit"),icon:"el-icon-edit",exec:this.handleEdit},{tip:this.$t("commons.copy"),icon:"el-icon-copy-document",type:"success",exec:this.handleCopy},{tip:this.$t("commons.delete"),icon:"el-icon-delete",type:"danger",exec:this.handleDelete}],statusFilters:[{text:"Saved",value:"Saved"},{text:"Starting",value:"Starting"},{text:"Running",value:"Running"},{text:"Reporting",value:"Reporting"},{text:"Completed",value:"Completed"},{text:"Error",value:"Error"}]}},watch:{$route:"init"},methods:{create:function(){this.$router.push("/api/test/create")},select:function(e){var t=this;this.selectIds.clear(),this.selectProjectNames.clear(),this.selectProjectId.clear(),e.forEach((function(e){t.selectIds.add(e.id),t.selectProjectNames.add(e.projectName),t.selectProjectId.add(e.projectId)}))},runTest:function(){this.selectIds.size<1?this.$warning(this.$t("test_track.plan_view.select_manipulate")):this.$refs.OneClickOperation.openOneClickOperation()},search:function(){var e=this;"all"!==this.projectId&&(this.condition.projectId=this.projectId);var t="/api/list/"+this.currentPage+"/"+this.pageSize;this.result=this.$post(t,this.condition,(function(t){var i=t.data;e.total=i.itemCount,e.tableData=i.listObject}))},handleSelectionChange:function(e){this.multipleSelection=e},handleEdit:function(e){this.$router.push({path:"/api/test/edit?id="+e.id})},handleView:function(e){this.$router.push({path:"/api/test/view?id="+e.id})},handleDelete:function(e){var t=this;this.$alert(this.$t("load_test.delete_confirm")+e.name+"？","",{confirmButtonText:this.$t("commons.confirm"),callback:function(i){"confirm"===i&&(t.result=t.$post("/api/delete",{id:e.id},(function(){t.$success(t.$t("commons.delete_success")),t.search()})))}})},handleCopy:function(e){this.$refs.apiCopy.open(e)},init:function(){this.selectIds.clear(),this.selectProjectNames.clear(),this.selectIds.clear(),this.projectId=this.$route.params.projectId,this.projectId&&"all"!==this.projectId&&this.$store.commit("setProjectId",this.projectId),this.search()},sort:function(e){Object(U["d"])(e,this.condition),this.init()},filter:function(e){Object(U["a"])(e,this.condition),this.init()},historicalDataUpgrade:function(){this.selectIds.size<1?this.$warning(this.$t("test_track.plan_view.select_manipulate")):this.$refs.upgrade.openOneClickOperation()}},created:function(){this.init()}},q=J,W=(i("668a"),Object(g["a"])(q,n,s,!1,null,"164d5f40",null));t["default"]=W.exports},"4a4b":function(e,t,i){"use strict";i("dd789")},"63dc":function(e,t,i){},"641e":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e._t("header",(function(){return[i("el-input",{attrs:{placeholder:e.$t("test_track.module.search"),size:"small",clearable:!0},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})]})),i("el-tree",{ref:"tree",staticClass:"filter-tree node-tree",attrs:{data:e.extendTreeNodes,"default-expanded-keys":e.expandedNode,"node-key":"id","filter-node-method":e.filterNode,"expand-on-click-node":!1,"highlight-current":"",draggable:!e.disabled},on:{"node-drag-end":e.handleDragEnd,"node-expand":e.nodeExpand,"node-collapse":e.nodeCollapse},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,s=t.data;return[i("span",{staticClass:"custom-tree-node father",on:{click:function(t){return e.handleNodeSelect(n)}}},[s.isEdit?i("span",{on:{click:function(e){e.stopPropagation()}}},[i("el-input",{ref:"nameInput",staticClass:"name-input",attrs:{size:"mini"},on:{blur:function(t){return t.stopPropagation(),e.save(n,s)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.target.blur())}},model:{value:s.name,callback:function(t){e.$set(s,"name",t)},expression:"data.name"}})],1):e._e(),s.isEdit?e._e():i("span",{staticClass:"node-icon"},[i("i",{staticClass:"el-icon-folder"})]),s.isEdit?e._e():i("span",{staticClass:"node-title",domProps:{textContent:e._s(s.name)}}),"relevance"!==e.isDisplay?i("span",{staticClass:"count-title"},[i("span",{staticStyle:{color:"#6C317C"}},[e._v(e._s(s.caseNum))])]):e._e(),e.disabled?e._e():i("span",{staticClass:"node-operate child"},["root"!==s.id&&"默认模块"!==s.name?i("el-tooltip",{directives:[{name:"permission",rawName:"v-permission",value:e.updatePermission,expression:"updatePermission"}],staticClass:"item",attrs:{effect:"dark","open-delay":200,content:e.$t("test_track.module.rename"),placement:"top"}},[i("i",{staticClass:"el-icon-edit",on:{click:function(t){return t.stopPropagation(),e.edit(n,s)}}})]):e._e(),"默认模块"===s.name&&1!==s.level?i("el-tooltip",{directives:[{name:"permission",rawName:"v-permission",value:e.updatePermission,expression:"updatePermission"}],staticClass:"item",attrs:{effect:"dark","open-delay":200,content:e.$t("test_track.module.rename"),placement:"top"}},[i("i",{staticClass:"el-icon-edit",on:{click:function(t){return t.stopPropagation(),e.edit(n,s)}}})]):e._e(),i("el-tooltip",{directives:[{name:"permission",rawName:"v-permission",value:e.addPermission,expression:"addPermission"}],staticClass:"item",attrs:{effect:"dark","open-delay":200,content:e.$t("test_track.module.add_submodule"),placement:"top"}},[i("i",{staticClass:"el-icon-circle-plus-outline",on:{click:function(t){return t.stopPropagation(),e.append(n,s)}}})]),"默认模块"===s.name&&1!==s.level?i("el-tooltip",{directives:[{name:"permission",rawName:"v-permission",value:e.deletePermission,expression:"deletePermission"}],staticClass:"item",attrs:{effect:"dark","open-delay":200,content:e.$t("commons.delete"),placement:"top"}},[i("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.remove(n,s)}}})]):e._e(),"root"!==s.id&&"默认模块"!==s.name?i("el-tooltip",{directives:[{name:"permission",rawName:"v-permission",value:e.deletePermission,expression:"deletePermission"}],staticClass:"item",attrs:{effect:"dark","open-delay":200,content:e.$t("commons.delete"),placement:"top"}},[i("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.remove(n,s)}}})]):e._e()],1)])]}}])})],2)},s=[],a=(i("51b3"),i("5a05"),i("89a8"),i("1a91"),i("993f"),i("cfe5"),i("10dd"),{name:"MsNodeTree",components:{},data:function(){return{result:{},filterText:"",expandedNode:[],defaultProps:{children:"children",label:"label"},extendTreeNodes:[]}},props:{isDisplay:{type:String},type:{type:String,default:"view"},treeNodes:{type:Array},allLabel:{type:String,default:function(){return this.$t("commons.all_label.case")}},nameLimit:{type:Number,default:function(){return 50}},updatePermission:Array,addPermission:Array,deletePermission:Array},watch:{treeNodes:function(){this.init()},filterText:function(e){this.filter(e)}},computed:{disabled:function(){return"edit"!==this.type}},methods:{init:function(){var e=0;this.treeNodes.forEach((function(t){e+=t.caseNum})),this.extendTreeNodes=[],this.extendTreeNodes.unshift({id:"root",name:this.allLabel,level:0,children:this.treeNodes,caseNum:e>0?e:""}),0===this.expandedNode.length&&this.expandedNode.push("root")},handleNodeSelect:function(e){var t=[],i=[];this.getChildNodeId(e.data,t),this.getParentNodes(e,i),this.$emit("nodeSelectEvent",e,t,i)},filterNode:function(e,t){return!e||!!t.label&&-1!==t.label.indexOf(e.toLowerCase())},filter:function(e){var t=this;this.$nextTick((function(){t.$refs.tree.filter(e)}))},nodeExpand:function(e){e.id&&this.expandedNode.push(e.id)},nodeCollapse:function(e){e.id&&this.expandedNode.splice(this.expandedNode.indexOf(e.id),1)},edit:function(e,t,i){var n=this;this.$set(t,"isEdit",!0),this.$nextTick((function(){n.$refs.nameInput.focus(),i||n.$nextTick((function(){n.filter(n.filterText)}))}))},increase:function(e){this.traverse(e,(function(e){e.caseNum&&e.caseNum++}),!0),"root"===this.extendTreeNodes[0].id&&this.extendTreeNodes[0].caseNum++},decrease:function(e){this.traverse(e,(function(e){e.caseNum&&e.caseNum--}),!0),"root"===this.extendTreeNodes[0].id&&this.extendTreeNodes[0].caseNum--},traverse:function(e,t,i){for(var n=0;n<this.treeNodes.length;n++){var s=this.treeNodes[n];this._traverse(s,e,t,i)}},_traverse:function(e,t,i,n){if(e.id===t)return i&&i(e),!0;if(!e.children)return!1;for(var s=0;s<e.children.length;s++){var a=e.children[s],o=this._traverse(a,t,i,n);if(!0===o)return n&&i(e),o}},append:function(e,t){var i=this,n={id:void 0,isEdit:!1,name:"",children:[]};t.children||this.$set(t,"children",[]),t.children.push(n),this.edit(e,n,!0),e.expanded=!0,this.$nextTick((function(){i.$refs.nameInput.focus()}))},save:function(e,t){if(""!==t.name.trim())if(t.name.trim().length>this.nameLimit)this.$warning(this.$t("test_track.length_less_than")+this.nameLimit);else if(t.name.indexOf("\\")>-1)this.$warning(this.$t("commons.node_name_tip"));else{var i={};this.buildSaveParam(i,e.parent.data,t),"edit"===i.type?this.$emit("edit",i):this.$emit("add",i),this.$set(t,"isEdit",!1)}else this.$warning(this.$t("test_track.case.input_name"))},remove:function(e,t){var i=this;if(void 0!==t.label){var n="确定删除节点 "+t.label+" 及其子节点下所有资源？";this.$alert(n,"",{confirmButtonText:this.$t("commons.confirm"),callback:function(t){if("confirm"===t){var n=[];i.getChildNodeId(e.data,n),i.$emit("remove",n)}}})}else this.$refs.tree.remove(e)},handleDragEnd:function(e,t,i,n){if("none"!==i&&void 0!==i){if("root"===t.data.id&&"before"===i||"默认模块"===e.data.name)return this.$emit("refresh"),!1;var s=this.buildParam(e,t,i),a=[];this.getNodeTree(this.treeNodes,e.data.id,a),"root"===s.parentId&&(s.parentId=void 0),this.$emit("drag",s,a)}},buildSaveParam:function(e,t,i){i.id?(e.nodeIds=[],e.type="edit",e.id=i.id,e.level=i.level,this.getChildNodeId(i,e.nodeIds)):(e.level=1,e.type="add","root"!=t.id&&(e.parentId=t.id,e.level=t.level+1)),e.name=i.name.trim(),e.label=i.name},buildParam:function(e,t,i){var n={};n.id=e.data.id,n.name=e.data.name,n.projectId=e.data.projectId,"inner"===i?(n.parentId=t.data.id,n.level=t.data.level+1):t.parent.id&&0!==t.parent.id?(n.parentId=t.parent.data.id,n.level=t.parent.data.level+1):(n.parentId=0,n.level=1);var s=[];if(this.getChildNodeId(e.data,s),1==t.data.level&&"inner"!=i)n.nodeTree=e.data;else for(var a=0;a<this.treeNodes.length;a++)if(n.nodeTree=this.findTreeByNodeId(this.treeNodes[a],t.data.id),n.nodeTree)break;return n.nodeIds=s,n},getNodeTree:function(e,t,i){if(e)for(var n=0;n<e.length;n++){if(e[n].id===t)return i[0]=n-1>=0?e[n-1].id:"",i[1]=e[n].id,void(n+1<e.length?i[2]=e[n+1].id:i[2]="");e[n].children&&this.getNodeTree(e[n].children,t,i)}},findTreeByNodeId:function(e,t){if(e.id==t)return e;if(e.children)for(var i=0;i<e.children.length;i++)if(this.findTreeByNodeId(e.children[i],t))return e},getChildNodeId:function(e,t){if(t.push(e.id),e.children)for(var i=0;i<e.children.length;i++)this.getChildNodeId(e.children[i],t)},getParentNodes:function(e,t){e.parent&&0!=e.parent.id&&this.getParentNodes(e.parent,t),e.data.name&&""!=e.data.name&&t.push(e.data)}}}),o=a,r=(i("4a4b"),i("cba8")),l=Object(r["a"])(o,n,s,!1,null,"7be2c578",null);t["a"]=l.exports},"668a":function(e,t,i){"use strict";i("964a")},"74cc":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",["Starting"===e.row.status?i("el-tag",{attrs:{size:"mini",type:"primary"}},[e._v(" "+e._s(e.row.status)+" ")]):"Running"===e.row.status?i("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(" "+e._s(e.row.status)+" ")]):"Reporting"===e.row.status?i("el-tag",{attrs:{size:"mini",type:"warning"}},[e._v(" "+e._s(e.row.status)+" ")]):"Error"===e.row.status?i("el-tooltip",{attrs:{placement:"top",effect:"light"},scopedSlots:e._u([{key:"content",fn:function(){return[i("div",[e._v(e._s(e.row.description))])]},proxy:!0}])},[i("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v(" "+e._s(e.row.status)+" ")])],1):i("el-tag",{attrs:{size:"mini",type:"info"}},[e._v(" "+e._s(e.row.status)+" ")])],1)},s=[],a={name:"MsApiTestStatus",props:{row:Object}},o=a,r=i("cba8"),l=Object(r["a"])(o,n,s,!1,null,"c4d75b58",null);t["a"]=l.exports},"964a":function(e,t,i){},dd789:function(e,t,i){},f968:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"select-menu"},[i("span",{staticClass:"menu-title"},[e._v(e._s("["+e.title+"]"))]),i("el-select",{style:{width:e.width},attrs:{slot:"prepend",filterable:"",size:"small"},on:{change:e.changeData},slot:"prepend",model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.data,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:t}})})),1)],1)},s=[],a=(i("10dd"),{name:"SelectMenu",props:{data:{type:Array},currentData:{type:Object},title:{type:String},width:{type:String,default:function(){return"214px"}}},data:function(){return{value:""}},watch:{currentData:function(e){void 0!=e&&null!=e&&(this.value=e.name)}},methods:{changeData:function(e){this.$emit("dataChange",this.data[e])}}}),o=a,r=(i("0ccc"),i("cba8")),l=Object(r["a"])(o,n,s,!1,null,"3a00cab0",null);t["a"]=l.exports}}]);