(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-364270c7"],{"03fd":function(t,e,a){"use strict";a("2f3b")},"1363d":function(t,e,a){t.exports=a.p+"img/tapd-user.5da8b715.png"},"2f3b":function(t,e,a){},"4ff7":function(t,e,a){},"6f01":function(t,e,a){"use strict";a("95c4")},"8bf7":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.result.loading,expression:"result.loading"}]},[a("el-card",{staticClass:"table-card",scopedSlots:t._u([{key:"header",fn:function(){return[a("div",[a("el-row",{attrs:{type:"flex",just:"",ify:"space-between",align:"middle"}},[a("span",{staticClass:"title"},[t._v(t._s(t.$t("commons.personal_info")))])])],1)]},proxy:!0}])},[a("el-table",{staticClass:"adjust-table",staticStyle:{width:"100%"},attrs:{border:"",data:t.tableData}},[a("el-table-column",{attrs:{prop:"id",label:"ID"}}),a("el-table-column",{attrs:{prop:"name",label:t.$t("commons.username")}}),a("el-table-column",{attrs:{prop:"email",label:t.$t("commons.email")}}),a("el-table-column",{attrs:{prop:"phone",label:t.$t("commons.phone")}}),a("el-table-column",{attrs:{prop:"createTime",label:t.$t("commons.create_time")},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("timestampFormatDate")(e.row.createTime)))])]}}])}),a("el-table-column",{attrs:{label:t.$t("commons.operating")},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("ms-table-operator-button",{attrs:{tip:t.$t("member.edit_information"),icon:"el-icon-edit",type:"primary"},on:{exec:function(a){return t.edit(e.row)}}}),t.isLocalUser?a("ms-table-operator-button",{attrs:{tip:t.$t("member.edit_password"),icon:"el-icon-s-tools",type:"success"},on:{exec:function(a){return t.editPassword(e.row)}}}):t._e()],1)]}}])})],1)],1),a("el-dialog",{attrs:{"close-on-click-modal":!1,title:t.$t("member.modify_personal_info"),visible:t.updateVisible,width:"40%","destroy-on-close":!0},on:{"update:visible":function(e){t.updateVisible=e},close:t.handleClose},scopedSlots:t._u([{key:"footer",fn:function(){return[a("ms-dialog-footer",{on:{cancel:function(e){t.updateVisible=!1},confirm:function(e){return t.updateUser("updateUserForm")}}})]},proxy:!0}])},[a("el-form",{ref:"updateUserForm",attrs:{model:t.form,"label-position":"right","label-width":"100px",size:"small",rules:t.rule}},[a("el-form-item",{attrs:{label:"ID",prop:"id"}},[a("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:t.form.id,callback:function(e){t.$set(t.form,"id",e)},expression:"form.id"}})],1),a("el-form-item",{attrs:{label:t.$t("commons.username"),prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:t.$t("commons.email"),prop:"email"}},[a("el-input",{attrs:{autocomplete:"off",disabled:!t.isLocalUser},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),a("el-form-item",{attrs:{label:t.$t("commons.phone"),prop:"phone"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1)],1),t.hasJira?a("jira-user-info",{attrs:{data:t.currentPlatformInfo},on:{auth:t.handleAuth}}):t._e(),t.hasTapd?a("tapd-user-info",{attrs:{data:t.currentPlatformInfo},on:{auth:t.handleAuth}}):t._e(),t.hasZentao?a("zentao-user-info",{attrs:{data:t.currentPlatformInfo},on:{auth:t.handleAuth}}):t._e(),t.hasAzure?a("azure-devops-user-info",{attrs:{data:t.currentPlatformInfo},on:{auth:t.handleAuth}}):t._e()],1),a("el-dialog",{attrs:{"close-on-click-modal":!1,title:t.$t("member.edit_password"),visible:t.editPasswordVisible,width:"35%","destroy-on-close":!0,left:""},on:{"update:visible":function(e){t.editPasswordVisible=e},close:t.handleClose}},[a("el-form",{ref:"editPasswordForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[a("el-form-item",{staticStyle:{"margin-bottom":"29px"},attrs:{label:t.$t("member.old_password"),prop:"password"}},[a("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:t.ruleForm.password,callback:function(e){t.$set(t.ruleForm,"password",e)},expression:"ruleForm.password"}})],1),a("el-form-item",{attrs:{label:t.$t("member.new_password"),prop:"newpassword"}},[a("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:t.ruleForm.newpassword,callback:function(e){t.$set(t.ruleForm,"newpassword",e)},expression:"ruleForm.newpassword"}})],1),a("el-form-item",{attrs:{label:t.$t("member.repeat_password"),prop:"repeatPassword"}},[a("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:t.ruleForm.repeatPassword,callback:function(e){t.$set(t.ruleForm,"repeatPassword",e)},expression:"ruleForm.repeatPassword"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("ms-dialog-footer",{on:{cancel:function(e){t.editPasswordVisible=!1},confirm:function(e){return t.updatePassword("editPasswordForm")}}})],1)],1)],1)},o=[],s=a("597f"),i=(a("8ea3"),a("87d5"),a("4abd")),n=a("15bc"),l=a("495f"),u=a("be8e"),c=a("e46e"),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{"label-position":"right","label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"Jira 信息"}},[a("ms-instructions-icon",{attrs:{size:"10",content:"该信息为通过Jira提交缺陷的用户认证信息，若未填写，则使用组织中配置的默认信息"}})],1),a("el-form-item",{attrs:{label:"Jira "+t.$t("organization.integration.account"),prop:"account"}},[a("el-input",{attrs:{placeholder:t.$t("organization.integration.input_api_account")},model:{value:t.data.jiraAccount,callback:function(e){t.$set(t.data,"jiraAccount",e)},expression:"data.jiraAccount"}})],1),a("el-form-item",{attrs:{label:"Jira "+t.$t("organization.integration.password"),prop:"password"}},[a("el-input",{attrs:{"auto-complete":"new-password",placeholder:t.$t("organization.integration.input_api_password"),"show-password":""},model:{value:t.data.jiraPassword,callback:function(e){t.$set(t.data,"jiraPassword",e)},expression:"data.jiraPassword"}})],1),a("el-form-item",[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$emit("auth","Jira")}}},[t._v(" "+t._s(t.$t("commons.validate"))+" ")])],1)],1)},p=[],d=a("60e1"),f={name:"JiraUserInfo",components:{MsInstructionsIcon:d["a"]},props:["data"]},b=f,h=(a("6f01"),a("cba8")),w=Object(h["a"])(b,m,p,!1,null,"553a7aa9",null),g=w.exports,_=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-form",{attrs:{"label-position":"right","label-width":"100px",size:"small"}},[r("el-form-item",{attrs:{label:"Tapd 昵称"}},[r("ms-instructions-icon",{attrs:{size:"10",effect:"light"}},[[r("img",{staticClass:"jira-image",attrs:{src:a("1363d")}})]],2)],1),r("el-form-item",{attrs:{label:"Tapd 昵称",prop:"account"}},[r("el-input",{attrs:{placeholder:t.$t("organization.integration.input_api_account")},model:{value:t.data.tapdUserName,callback:function(e){t.$set(t.data,"tapdUserName",e)},expression:"data.tapdUserName"}})],1),r("el-form-item",[r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$emit("auth","Tapd")}}},[t._v(" "+t._s(t.$t("commons.validate"))+" ")])],1)],1)},$=[],v={name:"TapdUserInfo",components:{MsInstructionsIcon:d["a"]},props:["data"]},z=v,P=(a("03fd"),Object(h["a"])(z,_,$,!1,null,"3ca4e210",null)),I=P.exports,x=a("422a");function y(t){return Object(x["get"])("/service/integration/all/"+Object(l["f"])(),(function(e){t&&t(e.data)}))}var j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{"label-position":"right","label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"禅道信息"}},[a("ms-instructions-icon",{attrs:{size:"10",content:"该信息为通过禅道提交缺陷的的用户名、密码，若未填写，则使用组织中配置的默认信息"}})],1),a("el-form-item",{attrs:{label:"禅道"+t.$t("organization.integration.account"),prop:"account"}},[a("el-input",{attrs:{placeholder:t.$t("organization.integration.input_api_account")},model:{value:t.data.zentaoUserName,callback:function(e){t.$set(t.data,"zentaoUserName",e)},expression:"data.zentaoUserName"}})],1),a("el-form-item",{attrs:{label:"禅道"+t.$t("organization.integration.password"),prop:"password"}},[a("el-input",{attrs:{"auto-complete":"new-password",placeholder:t.$t("organization.integration.input_api_password"),"show-password":""},model:{value:t.data.zentaoPassword,callback:function(e){t.$set(t.data,"zentaoPassword",e)},expression:"data.zentaoPassword"}})],1),a("el-form-item",[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$emit("auth","Zentao")}}},[t._v(" "+t._s(t.$t("commons.validate"))+" ")])],1)],1)},O=[],U={name:"ZentaoUserInfo",components:{MsInstructionsIcon:d["a"]},props:["data"]},k=U,F=(a("b17e"),Object(h["a"])(k,j,O,!1,null,"7c2b7bca",null)),A=F.exports,D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{"label-position":"right","label-width":"160px",size:"small"}},[a("el-form-item",{attrs:{label:"AzureDevops 信息"}},[a("ms-instructions-icon",{attrs:{size:"10",content:"该信息为通过Azure Devops提交缺陷的用户令牌信息，若未填写，则使用组织中配置的默认信息"}})],1),a("el-form-item",{attrs:{label:t.$t("organization.integration.azure_pat"),prop:"pat"}},[a("el-input",{attrs:{placeholder:t.$t("organization.integration.input_azure_pat")},model:{value:t.data.azureDevopsPat,callback:function(e){t.$set(t.data,"azureDevopsPat",e)},expression:"data.azureDevopsPat"}})],1),a("el-form-item",[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$emit("auth","AzureDevops")}}},[t._v(" "+t._s(t.$t("commons.validate"))+" ")])],1)],1)},J=[],T={name:"AzureDevopsUserInfo",components:{MsInstructionsIcon:d["a"]},props:["data"]},V=T,S=(a("e9ea"),Object(h["a"])(V,D,J,!1,null,"888aa0d4",null)),C=S.exports,Z={name:"MsPersonSetting",components:{ZentaoUserInfo:A,TapdUserInfo:I,JiraUserInfo:g,AzureDevopsUserInfo:C,MsDialogFooter:n["a"],MsTableOperatorButton:u["a"]},inject:["reload"],data:function(){return{result:{},isLocalUser:!1,updateVisible:!1,editPasswordVisible:!1,tableData:[],updatePath:"/user/update/current",updatePasswordPath:"/user/update/password",form:{platformInfo:{}},currentPlatformInfo:{jiraAccount:"",jiraPassword:"",tapdUserName:"",zentaoUserName:"",zentaoPassword:"",azureDevopsPat:""},ruleForm:{},hasJira:!1,hasTapd:!1,hasZentao:!1,hasAzure:!1,rule:{name:[{required:!0,message:this.$t("member.input_name"),trigger:"blur"},{min:2,max:20,message:this.$t("commons.input_limit",[2,20]),trigger:"blur"},{required:!0,pattern:/^[\u4e00-\u9fa5_a-zA-Z0-9.·-]+$/,message:this.$t("member.special_characters_are_not_supported"),trigger:"blur"}],phone:[{pattern:c["b"],message:this.$t("member.mobile_number_format_is_incorrect"),trigger:"blur"}],email:[{required:!0,message:this.$t("member.input_email"),trigger:"blur"},{required:!0,pattern:c["a"],message:this.$t("member.email_format_is_incorrect"),trigger:"blur"}]},rules:{password:[{required:!0,message:this.$t("user.input_password"),trigger:"blur"}],newpassword:[{required:!0,message:this.$t("user.input_password"),trigger:"blur"},{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,30}$/,message:this.$t("member.password_format_is_incorrect"),trigger:"blur"}],repeatPassword:[{required:!0,message:this.$t("user.input_password"),trigger:"blur"},{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,30}$/,message:this.$t("member.password_format_is_incorrect"),trigger:"blur"}]}}},activated:function(){this.initTableData()},methods:{currentUser:function(){return Object(l["h"])()},edit:function(t){this.updateVisible=!0,this.form=Object.assign({},t),this.getPlatformInfo(t),Object(l["v"])(this.handleClose)},getPlatformInfo:function(t){var e=this;t.platformInfo?this.form.platformInfo=JSON.parse(t.platformInfo):this.form.platformInfo={};var a=Object(l["f"])();this.form.platformInfo[a]||(this.form.platformInfo[a]={}),this.currentPlatformInfo=this.form.platformInfo[a],this.result=y((function(t){var a=t.map((function(t){return t.platform}));-1!==a.indexOf("Tapd")&&(e.hasTapd=!0),-1!==a.indexOf("Jira")&&(e.hasJira=!0),-1!==a.indexOf("Zentao")&&(e.hasZentao=!0),-1!==a.indexOf("AzureDevops")&&(e.hasAzure=!0)}))},editPassword:function(t){this.editPasswordVisible=!0,Object(l["v"])(this.handleClose)},cancel:function(){this.editPasswordVisible=!1,this.ruleForm.password="",this.ruleForm.newpassword=""},closeDialog:function(){this.editPasswordVisible=!1,this.ruleForm.password="",this.ruleForm.newpassword=""},updateUser:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;var a={};Object.assign(a,e.form),a.platformInfo=JSON.stringify(e.form.platformInfo),e.result=e.$post(e.updatePath,a,(function(t){e.$success(e.$t("commons.modify_success")),localStorage.setItem(i["M"],JSON.stringify(t.data)),e.updateVisible=!1,e.initTableData(),e.reload()}))}))},updatePassword:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;e.ruleForm.newpassword===e.ruleForm.repeatPassword?e.result=e.$post(e.updatePasswordPath,e.ruleForm,(function(t){e.$success(e.$t("commons.modify_success")),e.editPasswordVisible=!1,e.initTableData(),e.reload()})):e.$warning(e.$t("member.inconsistent_passwords"))}))},initTableData:function(){var t=this;this.result=this.$get("/user/info/"+encodeURIComponent(this.currentUser().id),(function(e){var a=e.data;t.isLocalUser="LOCAL"===e.data.source;var r=[];r[0]=a,t.tableData=r,t.handleRouteOpen()}))},handleRouteOpen:function(){var t=this.$route.params;t.open&&(this.edit(this.tableData[0]),t.open=!1)},handleAuth:function(t){var e=this,a=Object(s["a"])({},this.currentPlatformInfo);a.orgId=Object(l["f"])(),a.platform=t,this.$parent.result=this.$post("issues/user/auth",a,(function(){e.$success(e.$t("organization.integration.verified"))}))},handleClose:function(){this.form={},this.ruleForm={},Object(l["z"])(this.handleClose),this.editPasswordVisible=!1,this.updateVisible=!1}}},N=Z,q=Object(h["a"])(N,r,o,!1,null,"e74b57e0",null);e["default"]=q.exports},"95c4":function(t,e,a){},b17e:function(t,e,a){"use strict";a("4ff7")},d779:function(t,e,a){},e46e:function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return o}));var r="^1(3|4|5|6|7|8|9)\\d{9}$",o="^[a-zA-Z0-9_._-]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$"},e9ea:function(t,e,a){"use strict";a("d779")}}]);