(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08131e5f"],{"96c1":function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.result.loading,expression:"result.loading"}]},[o("el-card",{staticClass:"table-card",scopedSlots:e._u([{key:"header",fn:function(){return[o("ms-table-header",{attrs:{"create-permission":["ORGANIZATION_USER:READ+CREATE"],condition:e.condition,"create-tip":e.$t("member.create"),title:e.$t("commons.member")},on:{"update:condition":function(t){e.condition=t},search:e.initTableData,create:e.create}})]},proxy:!0}])},[o("el-table",{ref:"userTable",staticClass:"adjust-table",staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData,height:e.screenHeight}},[o("el-table-column",{attrs:{prop:"id",label:"ID"}}),o("el-table-column",{attrs:{prop:"name",label:e.$t("commons.username")}}),o("el-table-column",{attrs:{prop:"email",label:e.$t("commons.email")}}),o("el-table-column",{attrs:{prop:"phone",label:e.$t("commons.phone")}}),o("el-table-column",{attrs:{prop:"roles",label:e.$t("commons.group"),width:"140"},scopedSlots:e._u([{key:"default",fn:function(e){return[o("ms-roles-tag",{attrs:{roles:e.row.groups}})]}}])}),o("el-table-column",{attrs:{label:e.$t("commons.operating")},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",[o("ms-table-operator",{attrs:{"edit-permission":["ORGANIZATION_USER:READ+EDIT"],"delete-permission":["ORGANIZATION_USER:READ+DELETE"],tip2:e.$t("commons.remove")},on:{editClick:function(o){return e.edit(t.row)},deleteClick:function(o){return e.del(t.row)}}})],1)]}}])})],1),o("ms-table-pagination",{attrs:{change:e.initTableData,"current-page":e.currentPage,"page-size":e.pageSize,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1),o("add-member",{ref:"addMember",attrs:{"group-type":"ORGANIZATION","group-scope-id":e.orgId},on:{submit:e.submitForm}}),o("el-dialog",{attrs:{"close-on-click-modal":!1,title:e.$t("member.modify"),visible:e.updateVisible,width:"30%","destroy-on-close":!0},on:{"update:visible":function(t){e.updateVisible=t},close:e.handleClose},scopedSlots:e._u([{key:"footer",fn:function(){return[o("ms-dialog-footer",{on:{cancel:function(t){e.updateVisible=!1},confirm:function(t){return e.updateOrgMember("updateUserForm")}}})]},proxy:!0}])},[o("el-form",{ref:"updateUserForm",attrs:{model:e.form,"label-position":"right","label-width":"100px",size:"small"}},[o("el-form-item",{attrs:{label:"ID",prop:"id"}},[o("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),o("el-form-item",{attrs:{label:e.$t("commons.username"),prop:"name"}},[o("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:e.$t("commons.email"),prop:"email"}},[o("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),o("el-form-item",{attrs:{label:e.$t("commons.phone"),prop:"phone"}},[o("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),o("el-form-item",{attrs:{label:e.$t("commons.group"),prop:"groupIds",rules:{required:!0,message:e.$t("group.please_select_group"),trigger:"change"}}},[o("el-select",{staticClass:"select-width",attrs:{multiple:"",placeholder:e.$t("group.please_select_group")},model:{value:e.form.groupIds,callback:function(t){e.$set(e.form,"groupIds",t)},expression:"form.groupIds"}},e._l(e.form.allgroups,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),o("user-cascader",{ref:"cascaderDialog",attrs:{lable:e.batchAddLable,title:e.batchAddTitle},on:{confirm:e.cascaderConfirm}})],1)},a=[],i=(o("89a8"),o("d25d"),o("b110"),o("fe35"),o("10dd"),o("1a91"),o("8ea3"),o("e766"),o("978f")),r=o("59d9"),n=o("10b9"),c=o("2edc"),l=o("1c98"),u=o("15bc"),d=o("495f"),m=o("665c"),h=o("e077"),p=o("6541"),b=o("eab7"),f=o("4abd"),g=o("bcc4"),$={name:"MsOrganizationMember",components:{AddMember:g["a"],MsCreateBox:i["a"],MsTablePagination:r["a"],MsTableHeader:n["a"],MsRolesTag:c["a"],MsTableOperator:l["a"],MsDialogFooter:u["a"],MsTableHeaderSelectPopover:m["a"],UserCascader:p["a"],ShowMoreBtn:b["a"]},activated:function(){this.initTableData()},data:function(){return{result:{},createVisible:!1,updateVisible:!1,screenHeight:"calc(100vh - 195px)",form:{},queryPath:"/user/org/member/list",condition:{},tableData:[],rules:{userIds:[{required:!0,message:this.$t("member.please_choose_member"),trigger:["blur"]}],groupIds:[{required:!0,message:this.$t("group.please_select_group"),trigger:["blur"]}]},multipleSelection:[],currentPage:1,pageSize:10,total:0,options:[],loading:!1,selectDataCounts:0,batchAddLable:this.$t("project.please_choose_workspace"),batchAddTitle:this.$t("project.batch_choose_workspace"),selectRows:new Set,referenced:!1,batchAddWorkspaceOptions:[],batchAddUserRoleOptions:[],buttons:[],userList:[]}},computed:{orgId:function(){return Object(d["f"])()}},methods:{currentUser:function(){return Object(d["h"])()},initTableData:function(){var e=this,t={name:this.condition.name,organizationId:this.orgId};this.result=this.$post(this.buildPagePath(this.queryPath),t,(function(t){var o=t.data;e.tableData=o.listObject;for(var s="/user/group/list/org/"+e.orgId,a=function(t){e.$get(s+"/"+encodeURIComponent(e.tableData[t].id),(function(o){var s=o.data;e.$set(e.tableData[t],"groups",s)}))},i=0;i<e.tableData.length;i++)a(i);e.total=o.itemCount,e.$nextTick((function(){this.checkTableRowIsSelect()}))}))},checkTableRowIsSelect:function(){var e=this;if(this.condition.selectAll){var t=this.condition.unSelectIds;this.tableData.forEach((function(o){t.indexOf(o.id)<0?(e.$refs.userTable.toggleRowSelection(o,!0),e.selectRows.has(o)||(e.$set(o,"showMore",!0),e.selectRows.add(o))):e.selectRows.has(o)&&(e.$set(o,"showMore",!1),e.selectRows.delete(o))}))}},buildPagePath:function(e){return e+"/"+this.currentPage+"/"+this.pageSize},handleClose:function(){this.form={},this.options=[],Object(d["z"])(this.handleClose),this.updateVisible=!1,this.createVisible=!1},edit:function(e){var t=this;this.updateVisible=!0,this.form=Object.assign({},e);var o=this.form.groups.map((function(e){return e.id}));this.result=this.$post("/user/group/list",{type:f["i"],resourceId:this.orgId},(function(e){t.$set(t.form,"allgroups",e.data)})),this.$set(this.form,"groupIds",o),Object(d["v"])(this.handleClose)},updateOrgMember:function(e){var t=this,o={id:this.form.id,name:this.form.name,email:this.form.email,phone:this.form.phone,groupIds:this.form.groupIds,organizationId:this.orgId};this.$refs[e].validate((function(e){e&&(t.result=t.$post("/organization/member/update",o,(function(){t.$success(t.$t("commons.modify_success")),t.updateVisible=!1,t.initTableData()})))}))},del:function(e){var t=this;this.$confirm(this.$t("member.remove_member"),"",{confirmButtonText:this.$t("commons.confirm"),cancelButtonText:this.$t("commons.cancel"),type:"warning"}).then((function(){t.result=t.$get("/user/org/member/delete/"+t.orgId+"/"+encodeURIComponent(e.id),(function(){t.$success(t.$t("commons.remove_success")),t.initTableData()}))})).catch((function(){t.$info(t.$t("commons.remove_cancel"))}))},create:function(){this.$refs.addMember.open(),Object(d["v"])(this.handleClose)},submitForm:function(e){var t=this;e["organizationId"]=this.orgId,this.result=this.$post("user/org/member/add",e,(function(){t.$success(t.$t("commons.save_success")),t.initTableData(),t.$refs.addMember.close()}))},initWorkspaceBatchProcessDataStruct:function(e){var t=this,o=Object(d["f"])();this.$get("/user/getWorkspaceDataStruct/"+o,(function(o){t.batchAddWorkspaceOptions=o.data,e&&t.$refs.cascaderDialog.open("ADD_WORKSPACE",t.batchAddWorkspaceOptions)}))},initRoleBatchProcessDataStruct:function(e){var t=this,o=Object(d["f"])();this.$get("/user/getUserRoleDataStruct/"+o,(function(o){t.batchAddUserRoleOptions=o.data,e&&t.$refs.cascaderDialog.open("ADD_USER_ROLE",t.batchAddUserRoleOptions)}))},handleSelectAll:function(e){Object(h["c"])(this,e,this.tableData,this.selectRows,this.condition),Object(h["A"])(this.tableData,this.condition,this.selectRows),this.selectDataCounts=Object(h["u"])(this.condition,this.total,this.selectRows),this.$emit("selection",e)},handleSelect:function(e,t){Object(h["b"])(this,e,t,this.selectRows),Object(h["A"])(this.tableData,this.condition,this.selectRows),this.selectDataCounts=Object(h["u"])(this.condition,this.total,this.selectRows),this.$emit("selection",e)},isSelectDataAll:function(e){this.condition.selectAll=e,Object(h["A"])(this.tableData,this.condition,this.selectRows),this.selectDataCounts=Object(h["u"])(this.condition,this.total,this.selectRows),Object(h["B"])(this.$refs.userTable,this.tableData,this.selectRows)},addWorkspaceBatch:function(){0==this.batchAddWorkspaceOptions.length?this.initWorkspaceBatchProcessDataStruct(!0):this.$refs.cascaderDialog.open("ADD_WORKSPACE",this.batchAddWorkspaceOptions)},addUserRoleBatch:function(){0==this.batchAddUserRoleOptions.length?this.initRoleBatchProcessDataStruct(!0):this.$refs.cascaderDialog.open("ADD_USER_ROLE",this.batchAddUserRoleOptions)},cascaderConfirm:function(e,t){var o=this;0==t.length&&this.$success(this.$t("commons.modify_success"));var s={};s=this.buildBatchParam(s),s.organizationId=Object(d["f"])(),s.batchType=e,s.batchProcessValue=t,this.$post("/user/special/batchProcessUserInfo",s,(function(){o.$success(o.$t("commons.modify_success")),o.initTableData(),o.$refs.cascaderDialog.close()}))},buildBatchParam:function(e){return e.ids=Array.from(this.selectRows).map((function(e){return e.id})),e.projectId=Object(d["g"])(),e.condition=this.condition,e}}},D=$,O=(o("a24b"),o("cba8")),R=Object(O["a"])(D,s,a,!1,null,"9bf9679a",null);t["default"]=R.exports},a24b:function(e,t,o){"use strict";o("dc67")},dc67:function(e,t,o){}}]);